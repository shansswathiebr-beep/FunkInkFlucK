<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>FUNKENFLUG v3.3</title>
    
    <style>
        :root {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-glass: rgba(20, 20, 20, 0.95);
            --gold: #d4af37;
            --gold-light: #f4d03f;
            --gold-dark: #b8960c;
            --danger: #ff3333;
            --success: #00c853;
            --accent: #2979ff;
            --text: #ffffff;
            --text-secondary: #888888;
            --border: rgba(212, 175, 55, 0.3);
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent;
            font-family: 'Helvetica Neue', system-ui, -apple-system, sans-serif;
            user-select: none;
            -webkit-user-select: none;
        }

        html, body { 
            height: 100%; 
            background: var(--bg-primary); 
            color: var(--text); 
            overflow: hidden; 
            position: fixed; 
            width: 100%;
            touch-action: manipulation;
        }

        .app { 
            display: flex; 
            flex-direction: column; 
            height: 100%; 
            position: relative;
            background: radial-gradient(ellipse at top, #1a1a1a 0%, #000000 70%);
        }

        .header { 
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 50px;
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            padding: 0 20px; 
            padding-top: env(safe-area-inset-top, 10px);
            z-index: 100;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 100%);
            pointer-events: none;
        }

        .header > * { pointer-events: auto; }

        .logo {
            font-size: 18px;
            font-weight: 300;
            letter-spacing: 4px;
            color: var(--gold);
            text-transform: uppercase;
        }

        .pot-indicator {
            background: rgba(212, 175, 55, 0.15);
            border: 1px solid var(--border);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            color: var(--gold);
            display: none;
            align-items: center;
            gap: 6px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .pot-indicator.active { display: flex; animation: pulse 2s infinite; }

        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; box-shadow: 0 0 20px rgba(212, 175, 55, 0.3); }
        }

        .content { 
            flex: 1; 
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .overlay {
            position: absolute;
            inset: 0;
            background: var(--bg-primary);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .overlay.active { display: flex; opacity: 1; }

        .glass-card {
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 32px;
            width: 100%;
            max-width: 400px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
        }

        .language-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            width: 100%;
            max-width: 320px;
            margin-top: 30px;
        }

        .lang-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            color: var(--text);
            padding: 16px;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .lang-btn:hover, .lang-btn:active {
            background: var(--gold);
            color: #000;
            border-color: var(--gold);
            transform: scale(0.98);
        }

        .player-queue {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 50;
            transition: transform 0.3s ease, opacity 0.3s;
            max-width: 90%;
            overflow-x: auto;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
            padding: 0 10px;
        }

        .player-queue::-webkit-scrollbar { display: none; }
        .player-queue.hidden { transform: translateX(-50%) translateY(100px); opacity: 0; }

        .player-chip {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            color: var(--text-secondary);
            transition: all 0.3s;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .player-chip.active {
            background: var(--gold);
            color: #000;
            border-color: var(--gold);
            transform: scale(1.1);
            font-weight: 600;
        }

        .player-chip.out { opacity: 0.2; text-decoration: line-through; }
        .player-chip.pot-owner { border-color: var(--gold); box-shadow: 0 0 10px rgba(212,175,55,0.5); }

        .game-card {
            background: linear-gradient(135deg, rgba(20,20,20,0.95) 0%, rgba(10,10,10,0.98) 100%);
            border: 1px solid var(--border);
            border-radius: 32px;
            padding: 40px 30px;
            width: 90%;
            max-width: 380px;
            text-align: center;
            position: relative;
            overflow: hidden;
            display: none;
            box-shadow: 0 0 60px rgba(212, 175, 55, 0.1);
        }

        .game-card.active {
            display: block;
            animation: cardEnter 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes cardEnter {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .card-glow {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
        }

        .card-type {
            font-size: 11px;
            letter-spacing: 4px;
            text-transform: uppercase;
            color: var(--gold);
            margin-bottom: 24px;
            font-weight: 600;
        }

        .card-content {
            font-size: 24px;
            line-height: 1.4;
            font-weight: 300;
            margin-bottom: 30px;
            color: var(--text);
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
        }

        .tabu-forbidden {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-top: 20px;
        }

        .tabu-word {
            background: rgba(255, 51, 51, 0.1);
            color: var(--danger);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 13px;
            border: 1px solid rgba(255, 51, 51, 0.3);
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            width: 100%;
            padding: 16px;
            border-radius: 16px;
            border: none;
            background: rgba(255,255,255,0.05);
            color: var(--text);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
            touch-action: manipulation;
        }

        .btn:active { transform: scale(0.96); }

        .btn-gold {
            background: var(--gold);
            color: #000;
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
        }

        .btn-danger {
            background: rgba(255, 51, 51, 0.1);
            color: var(--danger);
            border: 1px solid rgba(255, 51, 51, 0.3);
        }

        .btn-success {
            background: rgba(0, 200, 83, 0.1);
            color: var(--success);
            border: 1px solid rgba(0, 200, 83, 0.3);
        }

        .btn-group {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .btn-group .btn { flex: 1; }

        .fab-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px;
            padding-bottom: env(safe-area-inset-bottom, 20px);
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 100%);
            display: none;
            flex-direction: column;
            gap: 10px;
            z-index: 40;
        }

        .fab-container.active { display: flex; }

        .dice-container {
            display: flex;
            gap: 30px;
            justify-content: center;
            align-items: center;
            height: 200px;
        }

        .dice {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
            border: 1px solid var(--border);
            border-radius: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .dice:active { transform: scale(0.9); }
        .dice.rolling { animation: rollDice 0.5s infinite; }

        @keyframes rollDice {
            0% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }

        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .modal.active { display: flex; }

        .bet-interface {
            background: var(--bg-glass);
            border: 1px solid var(--gold);
            border-radius: 24px;
            padding: 24px;
            width: 100%;
            max-width: 400px;
        }

        .bet-title {
            font-size: 20px;
            color: var(--gold);
            text-align: center;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .bet-input {
            width: 100%;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 14px;
            color: var(--text);
            font-size: 16px;
            margin-bottom: 16px;
            outline: none;
        }

        .bet-input:focus { border-color: var(--gold); }

        .bet-info {
            font-size: 12px;
            color: var(--text-secondary);
            text-align: center;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .bj-table {
            background: rgba(0,50,0,0.3);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(0,200,83,0.3);
        }

        .bj-hand {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 15px 0;
            min-height: 80px;
            flex-wrap: wrap;
        }

        .bj-card {
            width: 50px;
            height: 75px;
            background: linear-gradient(135deg, #fff 0%, #e0e0e0 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 700;
            color: #000;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            flex-shrink: 0;
        }

        .bj-card.red { color: var(--danger); }
        .bj-card.hidden { 
            background: linear-gradient(135deg, #b91c1c, #7f1d1d); 
            color: transparent;
            position: relative;
        }
        .bj-card.hidden::after {
            content: 'üÇ†';
            position: absolute;
            color: rgba(255,255,255,0.3);
            font-size: 30px;
        }

        .start-screen { text-align: center; }

        .main-title {
            font-size: 48px;
            font-weight: 100;
            letter-spacing: 12px;
            color: var(--gold);
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .subtitle {
            font-size: 12px;
            letter-spacing: 6px;
            color: var(--text-secondary);
            margin-bottom: 60px;
            text-transform: uppercase;
        }

        .feature-tags {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .tag {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid var(--border);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 11px;
            color: var(--gold);
            letter-spacing: 1px;
        }

        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.5s ease; }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .toast {
            position: fixed; 
            top: 100px; 
            left: 50%; 
            transform: translateX(-50%);
            background: var(--gold); 
            color: #000; 
            padding: 12px 24px;
            border-radius: 12px; 
            font-weight: 600; 
            z-index: 10000;
            animation: fadeIn 0.3s ease;
            max-width: 90%;
            text-align: center;
        }

        .game-over-modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 2000;
            flex-direction: column;
        }

        .game-over-modal.active { display: flex; }

        @media (max-height: 700px) {
            .main-title { font-size: 36px; }
            .card-content { font-size: 20px; }
            .dice { width: 80px; height: 80px; font-size: 36px; }
        }

        @media (max-width: 380px) {
            .game-card { padding: 30px 20px; }
            .card-content { font-size: 20px; }
            .language-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <div class="app">
        <div class="header">
            <div class="logo">FUNKENFLUG</div>
            <div class="pot-indicator" id="potIndicator">
                <span>üé∞</span>
                <span id="potText">POT AKTIV</span>
            </div>
        </div>

        <div class="content">
            <!-- Language Selection -->
            <div id="overlay-language" class="overlay active">
                <div class="main-title" style="font-size: 32px; margin-bottom: 10px;">FUNKENFLUG</div>
                <div class="subtitle" id="langSubtitle">Choose your language</div>
                
                <div class="language-grid">
                    <button class="lang-btn" onclick="game.setLanguage('de')">üá©üá™ Deutsch</button>
                    <button class="lang-btn" onclick="game.setLanguage('en')">üá¨üáß English</button>
                    <button class="lang-btn" onclick="game.setLanguage('es')">üá™üá∏ Espa√±ol</button>
                    <button class="lang-btn" onclick="game.setLanguage('fr')">üá´üá∑ Fran√ßais</button>
                    <button class="lang-btn" onclick="game.setLanguage('it')">üáÆüáπ Italiano</button>
                    <button class="lang-btn" onclick="game.setLanguage('pt')">üáµüáπ Portugu√™s</button>
                    <button class="lang-btn" onclick="game.setLanguage('nl')">üá≥üá± Nederlands</button>
                </div>
            </div>

            <div id="overlay-start" class="overlay start-screen">
                <div class="main-title">FUNKEN<br>FLUG</div>
                <div class="subtitle" id="startSubtitle">High Stakes Edition</div>
                
                <div class="feature-tags">
                    <span class="tag" id="tag1">‚ö° 4 Modes</span>
                    <span class="tag" id="tag2">üé≤ Blackjack</span>
                    <span class="tag" id="tag3">üî• Risk x2</span>
                </div>

                <div style="width: 100%; max-width: 300px;">
                    <button class="btn btn-gold" onclick="game.showLobby()" id="btnNewGame" style="margin-bottom: 12px; height: 56px;">New Game</button>
                    <button class="btn" onclick="game.startBlackjackMode()" id="btnBjMode" style="background: rgba(0,200,83,0.1); color: var(--success); border: 1px solid rgba(0,200,83,0.3); margin-bottom: 12px;">üé∞ Blackjack Mode</button>
                    <button class="btn" onclick="game.showRules()" id="btnRules">Rules</button>
                    <button class="btn" onclick="game.showLanguage()" style="margin-top: 10px; background: rgba(255,255,255,0.05);">üåê Language</button>
                </div>
            </div>

            <div id="overlay-lobby" class="overlay">
                <div class="glass-card">
                    <div style="font-size: 20px; color: var(--gold); margin-bottom: 24px; text-align: center; letter-spacing: 2px;" id="lobbyTitle">PLAYERS</div>
                    <div id="lobbyList" style="margin-bottom: 20px;"></div>
                    <button class="btn" onclick="game.addPlayer()" style="margin-bottom: 12px; font-size: 24px; line-height: 0;">+</button>
                    <button class="btn btn-gold" onclick="game.startGame()" id="btnStart" style="margin-bottom: 12px;">Start</button>
                    <button class="btn" onclick="game.showStart()" id="btnBack">Back</button>
                </div>
            </div>

            <div id="overlay-game" class="overlay" style="padding: 0;">
                <div id="view-dice" class="dice-container">
                    <div class="dice" onclick="game.roll()">üé≤</div>
                    <div class="dice" onclick="game.roll()">üî•</div>
                </div>

                <div id="card-action" class="game-card">
                    <div class="card-glow"></div>
                    <div class="card-type" id="type-action">‚ö° Action</div>
                    <div class="card-content" id="text-action"></div>
                    <div id="sub-action" style="color: var(--gold); font-size: 14px;"></div>
                </div>

                <div id="card-quiz" class="game-card">
                    <div class="card-glow" style="background: linear-gradient(90deg, transparent, var(--accent), transparent);"></div>
                    <div class="card-type" style="color: var(--accent);" id="type-quiz">üß† Quiz</div>
                    <div class="card-content" id="text-quiz" style="font-size: 20px;"></div>
                    <div class="quiz-options" id="quiz-options"></div>
                </div>

                <div id="card-tabu" class="game-card">
                    <div class="card-glow" style="background: linear-gradient(90deg, transparent, var(--success), transparent);"></div>
                    <div class="card-type" style="color: var(--success);" id="type-tabu">üö´ Word Ban</div>
                    <div class="card-content" id="text-tabu" style="font-size: 28px; font-weight: 600; text-transform: uppercase;"></div>
                    <div class="tabu-forbidden" id="list-tabu"></div>
                </div>

                <div id="card-z" class="game-card">
                    <div class="card-glow" style="background: linear-gradient(90deg, transparent, var(--danger), transparent);"></div>
                    <div class="card-type" style="color: var(--danger);" id="type-z">üî• Hot Seat</div>
                    <div class="card-content" id="text-z" style="font-size: 22px;"></div>
                </div>

                <div id="card-chaos" class="game-card">
                    <div class="card-glow" style="background: linear-gradient(90deg, transparent, #ff00ff, transparent); box-shadow: 0 0 30px rgba(255,0,255,0.5);"></div>
                    <div class="card-type" style="color: #ff00ff;" id="type-chaos">‚ö†Ô∏è Wildcard</div>
                    <div class="card-content" id="text-chaos" style="color: #ff00ff; font-size: 20px;"></div>
                    <div id="sub-chaos" style="color: var(--text-secondary); font-size: 14px; margin-top: 10px;"></div>
                </div>
            </div>

            <!-- Blackjack Mode Overlay -->
            <div id="overlay-blackjack" class="overlay" style="padding: 0;">
                <div style="position: absolute; top: 60px; left: 20px; right: 20px; text-align: center;">
                    <div style="font-size: 24px; color: var(--gold); letter-spacing: 4px; margin-bottom: 10px;">BLACKJACK</div>
                    <div style="font-size: 12px; color: var(--text-secondary);" id="bjModeSubtitle">High Stakes Card Battle</div>
                </div>

                <div class="glass-card" style="margin-top: 40px; max-width: 360px;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 12px; color: var(--text-secondary); letter-spacing: 2px; margin-bottom: 5px;" id="bjDealerLabel">DEALER</div>
                        <div id="bjDealerScore" style="font-size: 24px; color: var(--gold); font-weight: 700;">?</div>
                    </div>
                    <div class="bj-hand" id="bjDealerHand" style="min-height: 90px;"></div>

                    <div style="text-align: center; font-size: 11px; color: #666; margin: 20px 0;" id="bjRulesText">
                        Closest to 21 wins ‚Ä¢ Ace = 1 or 11
                    </div>

                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 12px; color: var(--text-secondary); letter-spacing: 2px; margin-bottom: 5px;" id="bjPlayerLabel">YOU</div>
                        <div id="bjPlayerScoreDisplay" style="font-size: 32px; color: var(--success); font-weight: 700;">0</div>
                    </div>
                    <div class="bj-hand" id="bjPlayerHandDisplay" style="min-height: 90px;"></div>

                    <div class="btn-group" style="margin-top: 30px;">
                        <button class="btn" onclick="game.blackjackStand()" id="btnBjStand" style="height: 56px; background: rgba(255,255,255,0.1);">STAND</button>
                        <button class="btn btn-gold" onclick="game.blackjackHit()" id="btnBjHit" style="height: 56px;">HIT</button>
                    </div>
                    <button class="btn" onclick="game.endBlackjackMode()" id="btnBjExit" style="margin-top: 10px; background: rgba(255,51,51,0.1); color: var(--danger);">Exit</button>
                </div>
            </div>

            <div id="modal-bet" class="modal">
                <div class="bet-interface">
                    <div class="bet-title" id="betTitle">Place Bet</div>
                    <div class="bet-info" id="betInfo">
                        You have only 1 item left!<br>
                        Place a bet to stay in the game.
                    </div>
                    <input type="text" class="bet-input" id="videoUrl" placeholder="Paste video link..." inputmode="url" autocomplete="off">
                    <div style="display: flex; gap: 10px; margin-bottom: 16px;">
                        <button class="btn" onclick="game.setBetRounds(1)" id="btnRounds1" style="flex: 1;">1 Round<br><small>10s/Item</small></button>
                        <button class="btn" onclick="game.setBetRounds(3)" id="btnRounds3" style="flex: 1; opacity: 0.5;">3 Rounds<br><small>Risk x3</small></button>
                    </div>
                    <div id="betSummary" style="font-size: 13px; color: var(--gold); text-align: center; margin-bottom: 20px; min-height: 40px;">
                        Choose number of rounds
                    </div>
                    <button class="btn btn-gold" onclick="game.confirmBet()" id="btnConfirmBet">Confirm Bet</button>
                    <button class="btn btn-danger" onclick="game.fold()" id="btnFold" style="margin-top: 10px;">Fold (Out)</button>
                </div>
            </div>

            <div id="modal-challenge" class="modal">
                <div class="bet-interface">
                    <div class="bet-title" id="challengeTitle">Challenge Bet</div>
                    <div class="bet-info" id="challengeInfo">
                        Player X placed a bet.<br>
                        Challenge them for the same amount.
                    </div>
                    <div style="background: rgba(212,175,55,0.1); padding: 15px; border-radius: 12px; margin-bottom: 20px; border: 1px solid var(--border);">
                        <div style="font-size: 11px; color: var(--text-secondary); margin-bottom: 5px;" id="currentBetLabel">Current Bet:</div>
                        <div id="currentPotDetails" style="font-size: 14px; color: var(--gold);"></div>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-success" onclick="game.acceptChallenge(1)" id="btnChallenge1">1 Round<br>Play</button>
                        <button class="btn btn-success" onclick="game.acceptChallenge(3)" style="background: rgba(255,165,0,0.2); color: #ffa500; border-color: rgba(255,165,0,0.3);">3 Rounds<br>Risk x3</button>
                    </div>
                    <button class="btn" onclick="game.declineChallenge()" id="btnDecline" style="margin-top: 12px;">Decline</button>
                </div>
            </div>

            <div id="modal-overbid" class="modal">
                <div class="bet-interface">
                    <div class="bet-title" id="overbidTitle">Raise Bet</div>
                    <div class="bet-info" id="overbidInfo">
                        +5 Seconds = +1 Item<br>
                        Every additional 5s gives 1 Bonus Item
                    </div>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin: 30px 0;">
                        <button class="btn" onclick="game.adjustOverbid(-5)" style="width: 50px; height: 50px; border-radius: 50%; padding: 0; font-size: 24px;">-</button>
                        <div style="text-align: center;">
                            <div id="overbidTime" style="font-size: 32px; color: var(--gold); font-weight: 700;">+0s</div>
                            <div id="overbidBonus" style="font-size: 12px; color: var(--success); margin-top: 5px;">+0 Items</div>
                        </div>
                        <button class="btn" onclick="game.adjustOverbid(5)" style="width: 50px; height: 50px; border-radius: 50%; padding: 0; font-size: 24px;">+</button>
                    </div>
                    <button class="btn btn-gold" onclick="game.confirmOverbid()" id="btnConfirmOverbid">Raise</button>
                    <button class="btn" onclick="game.closeOverbid()" id="btnCancelOverbid" style="margin-top: 10px;">Cancel</button>
                </div>
            </div>

            <div id="modal-bj-challenge" class="modal">
                <div class="glass-card" style="max-width: 360px;">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 12px; color: var(--gold); letter-spacing: 2px; margin-bottom: 5px;">HIGH STAKES CHALLENGE</div>
                        <div style="font-size: 20px; font-weight: 700;">Blackjack</div>
                        <div id="bjRoundInfo" style="font-size: 11px; color: var(--text-secondary); margin-top: 5px;">Round 1/1</div>
                    </div>

                    <div class="bj-table">
                        <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">
                            <span id="bjOppName">Opponent</span>
                            <span id="bjOppScore" style="color: var(--gold); font-weight: 700;">?</span>
                        </div>
                        <div class="bj-hand" id="bjOppHand"></div>
                    </div>

                    <div style="text-align: center; font-size: 11px; color: #666; margin: 10px 0;" id="bjChallengeRules">
                        Closest to 21 wins
                    </div>

                    <div class="bj-table" style="border-color: var(--gold);">
                        <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">
                            <span id="bjYouLabel">YOU</span>
                            <span id="bjPlayerScore" style="color: var(--gold); font-weight: 700;">0</span>
                        </div>
                        <div class="bj-hand" id="bjPlayerHand"></div>
                    </div>

                    <div class="btn-group" style="margin-top: 20px;">
                        <button class="btn" onclick="game.bjStand()" id="btnStandChallenge" style="height: 50px;">STAND</button>
                        <button class="btn btn-gold" onclick="game.bjHit()" id="btnHitChallenge" style="height: 50px;">HIT</button>
                    </div>
                </div>
            </div>

            <!-- Game Over Overlay f√ºr Blackjack -->
            <div id="overlay-bj-gameover" class="game-over-modal">
                <div class="glass-card" style="text-align: center; max-width: 320px;">
                    <div style="font-size: 48px; margin-bottom: 20px;" id="bjResultIcon">üèÜ</div>
                    <div style="font-size: 24px; color: var(--gold); margin-bottom: 10px; font-weight: 300;" id="bjResultTitle">You Win!</div>
                    <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 30px;" id="bjResultMessage">Dealer busted with 24</div>
                    <button class="btn btn-gold" onclick="game.restartBlackjack()" style="margin-bottom: 10px;">Play Again</button>
                    <button class="btn" onclick="game.endBlackjackMode()">Exit to Menu</button>
                </div>
            </div>

            <div id="overlay-result" class="overlay">
                <div class="glass-card" style="text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 10px;">üèÜ</div>
                    <div style="font-size: 14px; color: var(--text-secondary); letter-spacing: 4px; margin-bottom: 10px;" id="winnerLabel">WINNER</div>
                    <div id="winnerName" style="font-size: 28px; color: var(--gold); font-weight: 300; letter-spacing: 2px; margin-bottom: 30px;">-</div>
                    <button class="btn btn-gold" onclick="game.reset()" id="btnNewRound">New Round</button>
                </div>
            </div>

            <div class="player-queue hidden" id="playerQueue"></div>

            <div class="fab-container" id="fabContainer">
                <button class="btn" onclick="game.startBlackjackChallenge()" id="btnHighStakes" style="background: rgba(255,165,0,0.1); color: #ffa500; border: 1px solid rgba(255,165,0,0.3); margin-bottom: 8px; display: none;">
                    üé∞ High Stakes Challenge
                </button>
                <div class="btn-group" id="gameControls">
                    <button class="btn btn-danger" onclick="game.fail()" id="btnStrip">Strip (-1)</button>
                    <button class="btn btn-success" onclick="game.success()" id="btnSuccess">Done ‚úì</button>
                </div>
                <button class="btn btn-gold" onclick="game.next()" id="btnNext" style="display: none;">Next ‚Üí</button>
            </div>

        </div>
    </div>

    <script>
        const I18N = {
            de: {
                subtitle: "High Stakes Edition",
                tag1: "‚ö° 4 Modi",
                tag2: "üé≤ Blackjack",
                tag3: "üî• Risiko x2",
                newGame: "Neues Spiel",
                rules: "Spielregeln",
                back: "Zur√ºck",
                players: "SPIELER",
                start: "Start",
                types: { action: "‚ö° Aktion", quiz: "üß† Quiz", tabu: "üö´ Wortverbot", z: "üî• Hitzefrei", chaos: "‚ö†Ô∏è Joker" },
                winner: "GEWINNER",
                newRound: "Neue Runde",
                betTitle: "Einsatz Setzen",
                betInfo: "Du hast nur noch 1 Kleidungsst√ºck!<br>Setze einen Einsatz um zu bleiben.",
                betPrompt: "Video-Link einf√ºgen...",
                chooseRounds: "W√§hle die Anzahl der Runden",
                confirmBet: "Einsatz Best√§tigen",
                fold: "Aufgeben (Out)",
                challengeTitle: "Einsatz Herausfordern",
                challengeInfo: "hat einen Einsatz gesetzt.<br>Fordere ihn heraus.",
                currentBet: "Aktueller Einsatz:",
                play1: "1 Runde<br>Spielen",
                play3: "3 Runden<br>Risiko x3",
                decline: "Ablehnen",
                overbidTitle: "Einsatz √úberbieten",
                overbidInfo: "+5 Sekunden = +1 Item<br>Jede zus√§tzliche 5s gibt 1 Bonus-Item",
                raise: "√úberbieten",
                cancel: "Abbrechen",
                bjRules: "Wer n√§her an 21 gewinnt",
                you: "DU",
                stand: "STOP",
                hit: "KARTE",
                round: "Runde",
                strip: "Strip (-1)",
                success: "Geschafft ‚úì",
                next: "Weiter ‚Üí",
                potActive: "POT AKTIV",
                bjMode: "Blackjack Modus",
                bjSubtitle: "High Stakes Kartenspiel",
                bjDealer: "BANK",
                bjPlayer: "DU",
                bjStand: "STOP",
                bjHit: "KARTE",
                bjExit: "Beenden",
                bjPlayAgain: "Nochmal spielen",
                bjWin: "Gewonnen!",
                bjLose: "Verloren!",
                bjDraw: "Unentschieden!",
                rulesText: `FUNKENFLUG - High Stakes Edition

REGELN:
‚Ä¢ 5 Kleidungsst√ºcke pro Spieler
‚Ä¢ W√ºrfeln f√ºr Aufgaben: Aktion, Quiz, Wortverbot, Hitzefrei
‚Ä¢ Joker-Events f√ºr √úberraschungen

BLACKJACK:
‚Ä¢ Spiele gegen die Bank oder andere
‚Ä¢ Wer n√§her an 21 gewinnt
‚Ä¢ Ass z√§hlt 1 oder 11

POT-SYSTEM:
‚Ä¢ Bei letztem Item: Einsatz setzen mit Video-Link
‚Ä¢ 10s pro Item bei Verlust
‚Ä¢ Herausforderung m√∂glich (1x oder 3x Runden)

√úberbieten: +5s = +1 Bonus-Item`,
                decks: {
                    actions: [
                        {t: "Tausche dein Oberteil mit links", i: 3}, {t: "Lass dich 30s kitzeln", i: 2},
                        {t: "Fl√ºstere ein Geheimnis ins Ohr", i: 4}, {t: "Trinke ohne H√§nde", i: 3},
                        {t: "Mach ein anz√ºgliches Kompliment", i: 2}, {t: "Ziehe etwas aus", i: 5},
                        {t: "Wahrheit oder Strip?", i: 4}, {t: "Simuliere sexy Werbung", i: 3},
                        {t: "Massiere die Schultern", i: 2}, {t: "Spiele Porno-Szene nach", i: 5},
                        {t: "Errate wer dich ber√ºhrt (blind)", i: 3}, {t: "Tausche den Platz", i: 2},
                        {t: "Zeige Dirty Talk Gesicht", i: 3}, {t: "Iss Eisw√ºrfel aus Dekollet√©", i: 4},
                        {t: "Erz√§hle peinlichste Sex-Story", i: 4}, {t: "Gib einen leidenschaftlichen Kuss", i: 3},
                        {t: "Lecke Schokolade vom Bauch", i: 5}, {t: "Mache einen Striptease (30s)", i: 5},
                        {t: "Tausche alle Klamotten mit rechts", i: 4}, {t: "Body-Scan der Person links", i: 4}
                    ],
                    quiz: [
                        {q: "Wie viele Schritte pro Tag (Durchschnitt)?", a: ["3.000", "10.000", "15.000"], c: 1},
                        {q: "Gr√∂√ütes innere Organ?", a: ["Herz", "Leber", "Lunge"], c: 1},
                        {q: "Z√§hne Erwachsener?", a: ["28", "32", "36"], c: 1},
                        {q: "Erstes iPhone Jahr?", a: ["2005", "2007", "2009"], c: 1},
                        {q: "Hauptstadt Australien?", a: ["Sydney", "Melbourne", "Canberra"], c: 2},
                        {q: "Planeten im Sonnensystem?", a: ["7", "8", "9"], c: 1},
                        {q: "Element 'Au'?", a: ["Silber", "Aluminium", "Gold"], c: 2},
                        {q: "Oscars f√ºr Titanic?", a: ["9", "11", "13"], c: 1},
                        {q: "Wie viele Herzen hat ein Oktopus?", a: ["1", "2", "3"], c: 2},
                        {q: "Gr√∂√ütes Land der Welt?", a: ["China", "USA", "Russland"], c: 2}
                    ],
                    tabu: [
                        {w: "Orgasmus", f: ["H√∂hepunkt", "Lust", "Kommen"]}, {w: "Kondom", f: ["Gummi", "Schutz", "Verh√ºtung"]},
                        {w: "Tinder", f: ["Dating", "Swipe", "Match"]}, {w: "Kamasutra", f: ["Stellung", "Buch", "Sex"]},
                        {w: "Striptease", f: ["Ausziehen", "Tanz", "Club"]}, {w: "One-Night-Stand", f: ["Sex", "Nacht", "Fremder"]},
                        {w: "Viagra", f: ["Potenz", "Pille", "Stehen"]}, {w: "Aphrodisiakum", f: ["Lust", "Mittel", "Essen"]},
                        {w: "Dreier", f: ["Sex", "Drei", "Gruppe"]}, {w: "Bondage", f: ["Seil", "Fesseln", "BDSM"]}
                    ],
                    z: ["Geheimste sexuelle Fantasie?", "Mit wem hier w√ºrdest du schlafen?", "Verruchteste Tat?", "Letzter Sex-Traum?", 
                        "Welche K√∂rperstelle macht dich am meisten an?", "Lieblingsstellung?", "Peinlichster Sex-Moment?", "Dominant oder devot?",
                        "Schonmal betrogen?", "Wann war dein letzter Sex?", "Gr√∂√üte Abturn?", "Schonmal ein Video gemacht?",
                        "Schonmal im Freien?", "Lieblings-Toy?", "Schonmal mit gleichem Geschlecht?"]
                },
                chaos: [
                    {n: "IDENTIT√ÑTSTAUSCH", t: "Tausche deine Identit√§t!", d: "Du spielst als die Person rechts.", e: "swap"},
                    {n: "DOPPELTER EINSATZ", t: "Alles z√§hlt doppelt!", d: "Strips werden verdoppelt.", e: "double"},
                    {n: "ZWANGS-BLACKJACK", t: "Nur Blackjack z√§hlt!", d: "Verlust = -3 Strips", e: "bjforced"},
                    {n: "ROLLENTAUSCH", t: "Links wird Rechts", d: "Die Richtungen sind vertauscht.", e: "reverse"},
                    {n: "ALLE GEGEN ALLE", t: "Jeder gegen Jeden!", d: "N√§chste Runde: Wer verliert, strippt alle.", e: "allvsall"}
                ]
            },
            en: {
                subtitle: "High Stakes Edition",
                tag1: "‚ö° 4 Modes",
                tag2: "üé≤ Blackjack",
                tag3: "üî• Risk x2",
                newGame: "New Game",
                rules: "Rules",
                back: "Back",
                players: "PLAYERS",
                start: "Start",
                types: { action: "‚ö° Action", quiz: "üß† Quiz", tabu: "üö´ Word Ban", z: "üî• Hot Seat", chaos: "‚ö†Ô∏è Wildcard" },
                winner: "WINNER",
                newRound: "New Round",
                betTitle: "Place Bet",
                betInfo: "You have only 1 item left!<br>Place a bet to stay in.",
                betPrompt: "Paste video link...",
                chooseRounds: "Choose number of rounds",
                confirmBet: "Confirm Bet",
                fold: "Fold (Out)",
                challengeTitle: "Challenge Bet",
                challengeInfo: "placed a bet.<br>Challenge them.",
                currentBet: "Current Bet:",
                play1: "1 Round<br>Play",
                play3: "3 Rounds<br>Risk x3",
                decline: "Decline",
                overbidTitle: "Raise Bet",
                overbidInfo: "+5 Seconds = +1 Item<br>Every extra 5s gives 1 Bonus Item",
                raise: "Raise",
                cancel: "Cancel",
                bjRules: "Closest to 21 wins",
                you: "YOU",
                stand: "STAND",
                hit: "HIT",
                round: "Round",
                strip: "Strip (-1)",
                success: "Done ‚úì",
                next: "Next ‚Üí",
                potActive: "POT ACTIVE",
                bjMode: "Blackjack Mode",
                bjSubtitle: "High Stakes Card Battle",
                bjDealer: "DEALER",
                bjPlayer: "YOU",
                bjStand: "STAND",
                bjHit: "HIT",
                bjExit: "Exit",
                bjPlayAgain: "Play Again",
                bjWin: "You Win!",
                bjLose: "You Lose!",
                bjDraw: "Push (Draw)!",
                rulesText: `FUNKENFLUG - High Stakes Edition

RULES:
‚Ä¢ 5 clothing items per player
‚Ä¢ Roll for tasks: Action, Quiz, Word Ban, Hot Seat
‚Ä¢ Wildcard events for surprises

BLACKJACK:
‚Ä¢ Play against the house or others
‚Ä¢ Closest to 21 wins
‚Ä¢ Ace counts as 1 or 11

POT SYSTEM:
‚Ä¢ At last item: Place bet with video link
‚Ä¢ 10s per item if lost
‚Ä¢ Challenge possible (1x or 3x rounds)

Raising: +5s = +1 Bonus Item`,
                decks: {
                    actions: [
                        {t: "Swap shirt with left", i: 3}, {t: "Get tickled for 30s", i: 2},
                        {t: "Whisper a secret", i: 4}, {t: "Drink without hands", i: 3},
                        {t: "Give a naughty compliment", i: 2}, {t: "Remove something", i: 5},
                        {t: "Truth or Strip?", i: 4}, {t: "Act sexy commercial", i: 3},
                        {t: "Massage shoulders", i: 2}, {t: "Act porn scene", i: 5},
                        {t: "Guess who touches you (blind)", i: 3}, {t: "Swap seats", i: 2},
                        {t: "Show dirty talk face", i: 3}, {t: "Eat ice from cleavage", i: 4},
                        {t: "Tell most embarrassing sex story", i: 4}, {t: "Give passionate kiss", i: 3},
                        {t: "Lick chocolate from belly", i: 5}, {t: "Striptease (30s)", i: 5},
                        {t: "Swap all clothes with right", i: 4}, {t: "Body-scan person left", i: 4}
                    ],
                    quiz: [
                        {q: "Steps per day (average)?", a: ["3,000", "10,000", "15,000"], c: 1},
                        {q: "Largest internal organ?", a: ["Heart", "Liver", "Lung"], c: 1},
                        {q: "Adult teeth count?", a: ["28", "32", "36"], c: 1},
                        {q: "First iPhone year?", a: ["2005", "2007", "2009"], c: 1},
                        {q: "Capital of Australia?", a: ["Sydney", "Melbourne", "Canberra"], c: 2},
                        {q: "Planets in solar system?", a: ["7", "8", "9"], c: 1},
                        {q: "Element 'Au'?", a: ["Silver", "Aluminum", "Gold"], c: 2},
                        {q: "Titanic Oscars?", a: ["9", "11", "13"], c: 1},
                        {q: "How many hearts octopus?", a: ["1", "2", "3"], c: 2},
                        {q: "Largest country?", a: ["China", "USA", "Russia"], c: 2}
                    ],
                    tabu: [
                        {w: "Orgasm", f: ["Climax", "Pleasure", "Come"]}, {w: "Condom", f: ["Rubber", "Protection", "Safe"]},
                        {w: "Tinder", f: ["Dating", "Swipe", "Match"]}, {w: "Kamasutra", f: ["Position", "Book", "Sex"]},
                        {w: "Striptease", f: ["Undress", "Dance", "Club"]}, {w: "One-Night-Stand", f: ["Sex", "Night", "Stranger"]},
                        {w: "Viagra", f: ["Potency", "Pill", "Hard"]}, {w: "Aphrodisiac", f: ["Lust", "Drug", "Food"]},
                        {w: "Threesome", f: ["Sex", "Three", "Group"]}, {w: "Bondage", f: ["Rope", "Tie", "BDSM"]}
                    ],
                    z: ["Secret sexual fantasy?", "Who here would you sleep with?", "Naughtiest deed?", "Last sex dream?", 
                        "Which body part turns you on most?", "Favorite position?", "Most embarrassing sex moment?", "Dom or sub?",
                        "Ever cheated?", "When was last sex?", "Biggest turn-off?", "Ever made a video?",
                        "Ever outdoors?", "Favorite toy?", "Ever same gender?"]
                },
                chaos: [
                    {n: "IDENTITY SWAP", t: "Swap your identity!", d: "You play as person on right.", e: "swap"},
                    {n: "DOUBLE BET", t: "Everything counts double!", d: "Strips are doubled.", e: "double"},
                    {n: "FORCED BLACKJACK", t: "Only Blackjack counts!", d: "Loss = -3 Strips", e: "bjforced"},
                    {n: "ROLE SWAP", t: "Left becomes Right", d: "Directions are swapped.", e: "reverse"},
                    {n: "FREE FOR ALL", t: "Everyone against everyone!", d: "Next round: Loser strips all.", e: "allvsall"}
                ]
            },
            es: {
                subtitle: "Edici√≥n Alto Riesgo",
                tag1: "‚ö° 4 Modos",
                tag2: "üé≤ Blackjack",
                tag3: "üî• Riesgo x2",
                newGame: "Nuevo Juego",
                rules: "Reglas",
                back: "Atr√°s",
                players: "JUGADORES",
                start: "Iniciar",
                types: { action: "‚ö° Acci√≥n", quiz: "üß† Quiz", tabu: "üö´ Palabra Prohibida", z: "üî• Asiento Caliente", chaos: "‚ö†Ô∏è Comod√≠n" },
                winner: "GANADOR",
                newRound: "Nueva Ronda",
                betTitle: "Hacer Apuesta",
                betInfo: "¬°Solo te queda 1 prenda!<br>Haz una apuesta para continuar.",
                betPrompt: "Pegar enlace de video...",
                chooseRounds: "Elige n√∫mero de rondas",
                confirmBet: "Confirmar Apuesta",
                fold: "Retirarse",
                challengeTitle: "Desafiar Apuesta",
                challengeInfo: "hizo una apuesta.<br>Desaf√≠alo.",
                currentBet: "Apuesta Actual:",
                play1: "1 Ronda<br>Jugar",
                play3: "3 Rondas<br>Riesgo x3",
                decline: "Rechazar",
                overbidTitle: "Subir Apuesta",
                overbidInfo: "+5 Segundos = +1 Prenda<br>Cada 5s extra da 1 Prenda Bonus",
                raise: "Subir",
                cancel: "Cancelar",
                bjRules: "El m√°s cercano a 21 gana",
                you: "T√ö",
                stand: "PLANTARSE",
                hit: "PEDIR",
                round: "Ronda",
                strip: "Quitar (-1)",
                success: "Hecho ‚úì",
                next: "Siguiente ‚Üí",
                potActive: "POT ACTIVO",
                bjMode: "Modo Blackjack",
                bjSubtitle: "Batalla de Cartas Alto Riesgo",
                bjDealer: "CRUPIER",
                bjPlayer: "T√ö",
                bjStand: "PLANTARSE",
                bjHit: "PEDIR",
                bjExit: "Salir",
                bjPlayAgain: "Jugar Otra Vez",
                bjWin: "¬°Ganaste!",
                bjLose: "¬°Perdiste!",
                bjDraw: "¬°Empate!",
                rulesText: `FUNKENFLUG - Edici√≥n Alto Riesgo

REGLAS:
‚Ä¢ 5 prendas por jugador
‚Ä¢ Lanza dados para tareas: Acci√≥n, Quiz, Palabra Prohibida, Asiento Caliente
‚Ä¢ Comodines para sorpresas

BLACKJACK:
‚Ä¢ Juega contra la banca u otros
‚Ä¢ El m√°s cercano a 21 gana
‚Ä¢ As vale 1 u 11

SISTEMA POT:
‚Ä¢ Con √∫ltima prenda: Apuesta con enlace de video
‚Ä¢ 10s por prenda si pierdes
‚Ä¢ Desaf√≠o posible (1x o 3x rondas)

Subir: +5s = +1 Prenda Bonus`,
                decks: {
                    actions: [
                        {t: "Cambia camisa izquierda", i: 3}, {t: "F√°zte cosquillas 30s", i: 2},
                        {t: "Susurra secreto", i: 4}, {t: "Bebe sin manos", i: 3},
                        {t: "Cumplido atrevido", i: 2}, {t: "Quita algo", i: 5},
                        {t: "¬øVerdad o Strip?", i: 4}, {t: "Act√∫a publicidad sexy", i: 3},
                        {t: "Masajea hombros", i: 2}, {t: "Act√∫a escena porno", i: 5},
                        {t: "Adivina qui√©n toca", i: 3}, {t: "Cambia asientos", i: 2},
                        {t: "Cara dirty talk", i: 3}, {t: "Come hielo escote", i: 4},
                        {t: "Historia sex vergonzosa", i: 4}, {t: "Beso apasionado", i: 3},
                        {t: "Lame chocolate vientre", i: 5}, {t: "Striptease (30s)", i: 5},
                        {t: "Cambia ropa derecha", i: 4}, {t: "Body-scan izquierda", i: 4}
                    ],
                    quiz: [
                        {q: "¬øPasos por d√≠a (promedio)?", a: ["3.000", "10.000", "15.000"], c: 1},
                        {q: "¬ø√ìrgano interno m√°s grande?", a: ["Coraz√≥n", "H√≠gado", "Pulm√≥n"], c: 1},
                        {q: "¬øDientes adultos?", a: ["28", "32", "36"], c: 1},
                        {q: "¬øPrimer iPhone a√±o?", a: ["2005", "2007", "2009"], c: 1},
                        {q: "¬øCapital de Australia?", a: ["Sydney", "Melbourne", "Canberra"], c: 2},
                        {q: "¬øPlanetas sistema solar?", a: ["7", "8", "9"], c: 1},
                        {q: "¬øElemento 'Au'?", a: ["Plata", "Aluminio", "Oro"], c: 2},
                        {q: "¬øOscars Titanic?", a: ["9", "11", "13"], c: 1},
                        {q: "¬øCorazones pulpo?", a: ["1", "2", "3"], c: 2},
                        {q: "¬øPa√≠s m√°s grande?", a: ["China", "USA", "Rusia"], c: 2}
                    ],
                    tabu: [
                        {w: "Orgasmo", f: ["Cl√≠max", "Placer", "Venir"]}, {w: "Cond√≥n", f: ["Goma", "Protecci√≥n", "Seguro"]},
                        {w: "Tinder", f: ["Citas", "Swipe", "Match"]}, {w: "Kamasutra", f: ["Posici√≥n", "Libro", "Sexo"]},
                        {w: "Striptease", f: ["Desvestir", "Baile", "Club"]}, {w: "Aventura", f: ["Sexo", "Noche", "Desconocido"]},
                        {w: "Viagra", f: ["Potencia", "Pastilla", "Duro"]}, {w: "Afrodis√≠aco", f: ["Lujuria", "Droga", "Comida"]},
                        {w: "Tr√≠o", f: ["Sexo", "Tres", "Grupo"]}, {w: "Bondage", f: ["Cuerda", "Atar", "BDSM"]}
                    ],
                    z: ["¬øFantas√≠a sexual secreta?", "¬øCon qui√©n dormir√≠as aqu√≠?", "¬øActo m√°s atrevido?", "¬ø√öltimo sue√±o er√≥tico?", 
                        "¬øQu√© parte te excita m√°s?", "¬øPosici√≥n favorita?", "¬øMomento sex m√°s vergonzoso?", "¬øDom o sumiso?",
                        "¬øHas enga√±ado?", "¬øCu√°ndo fue √∫ltima vez?", "¬øQu√© te apaga?", "¬øHas hecho video?",
                        "¬øAl aire libre?", "¬øJuguete favorito?", "¬øMismo g√©nero?"]
                },
                chaos: [
                    {n: "CAMBIO IDENTIDAD", t: "¬°Cambia tu identidad!", d: "Juegas como persona derecha.", e: "swap"},
                    {n: "APUESTA DOBLE", t: "¬°Todo cuenta doble!", d: "Strips se duplican.", e: "double"},
                    {n: "BLACKJACK FORZADO", t: "¬°Solo Blackjack cuenta!", d: "P√©rdida = -3 Strips", e: "bjforced"},
                    {n: "CAMBIO ROL", t: "Izquierda es Derecha", d: "Direcciones invertidas.", e: "reverse"},
                    {n: "CADA UNO POR S√ç", t: "¬°Cada uno por s√≠!", d: "Pr√≥xima ronda: perdedor strip.", e: "allvsall"}
                ]
            },
            fr: {
                subtitle: "√âdition Haut Risque",
                tag1: "‚ö° 4 Modes",
                tag2: "üé≤ Blackjack",
                tag3: "üî• Risque x2",
                newGame: "Nouveau Jeu",
                rules: "R√®gles",
                back: "Retour",
                players: "JOUEURS",
                start: "D√©marrer",
                types: { action: "‚ö° Action", quiz: "üß† Quiz", tabu: "üö´ Mot Interdit", z: "üî• Question Br√ªlante", chaos: "‚ö†Ô∏è Joker" },
                winner: "GAGNANT",
                newRound: "Nouvelle Manche",
                betTitle: "Parier",
                betInfo: "Il ne te reste qu'1 v√™tement!<br>Parie pour rester.",
                betPrompt: "Coller lien vid√©o...",
                chooseRounds: "Choisis le nombre de manches",
                confirmBet: "Confirmer",
                fold: "Se coucher",
                challengeTitle: "D√©fier",
                challengeInfo: "a pari√©.<br>D√©fie-le.",
                currentBet: "Mise actuelle:",
                play1: "1 Manche<br>Jouer",
                play3: "3 Manches<br>Risque x3",
                decline: "Refuser",
                overbidTitle: "Relancer",
                overbidInfo: "+5 Secondes = +1 V√™tement<br>Chaque 5s donne 1 Bonus",
                raise: "Relancer",
                cancel: "Annuler",
                bjRules: "Le plus proche de 21 gagne",
                you: "VOUS",
                stand: "RESTER",
                hit: "CARTE",
                round: "Manche",
                strip: "Strip (-1)",
                success: "Fait ‚úì",
                next: "Suivant ‚Üí",
                potActive: "POT ACTIF",
                bjMode: "Mode Blackjack",
                bjSubtitle: "Jeu de Cartes Haut Risque",
                bjDealer: "BANQUE",
                bjPlayer: "VOUS",
                bjStand: "RESTER",
                bjHit: "CARTE",
                bjExit: "Quitter",
                bjPlayAgain: "Rejouer",
                bjWin: "Gagn√©!",
                bjLose: "Perdu!",
                bjDraw: "√âgalit√©!",
                rulesText: `FUNKENFLUG - √âdition Haut Risque

R√àGLES:
‚Ä¢ 5 v√™tements par joueur
‚Ä¢ Lancez pour des t√¢ches: Action, Quiz, Mot Interdit, Question Br√ªlante
‚Ä¢ Jokers pour surprises

BLACKJACK:
‚Ä¢ Jouez contre la banque ou autres
‚Ä¢ Le plus proche de 21 gagne
‚Ä¢ As vaut 1 ou 11

SYST√àME POT:
‚Ä¢ Dernier v√™tement: Mise avec lien vid√©o
‚Ä¢ 10s par v√™tement si perdu
‚Ä¢ D√©fi possible (1x ou 3x manches)

Relance: +5s = +1 Bonus`,
                decks: {
                    actions: [
                        {t: "√âchange chemise gauche", i: 3}, {t: "Fais-toi chatouiller 30s", i: 2},
                        {t: "Chuchote un secret", i: 4}, {t: "Boire sans mains", i: 3},
                        {t: "Compliment os√©", i: 2}, {t: "Enl√®ve quelque chose", i: 5},
                        {t: "V√©rit√© ou Strip?", i: 4}, {t: "Imite pub sexy", i: 3},
                        {t: "Massage √©paules", i: 2}, {t: "Joue sc√®ne porno", i: 5},
                        {t: "Devine qui te touche", i: 3}, {t: "√âchange places", i: 2},
                        {t: "Visage dirty talk", i: 3}, {t: "Mange gla√ßon d√©collet√©", i: 4},
                        {t: "Histoire sex honteuse", i: 4}, {t: "Baiser passionn√©", i: 3},
                        {t: "L√®che chocolat ventre", i: 5}, {t: "Striptease (30s)", i: 5},
                        {t: "√âchange tous v√™tements", i: 4}, {t: "Body-scan gauche", i: 4}
                    ],
                    quiz: [
                        {q: "Pas par jour (moyenne)?", a: ["3.000", "10.000", "15.000"], c: 1},
                        {q: "Organe interne plus grand?", a: ["C≈ìur", "Foie", "Poumon"], c: 1},
                        {q: "Dents adulte?", a: ["28", "32", "36"], c: 1},
                        {q: "Premier iPhone ann√©e?", a: ["2005", "2007", "2009"], c: 1},
                        {q: "Capitale Australie?", a: ["Sydney", "Melbourne", "Canberra"], c: 2},
                        {q: "Plan√®tes syst√®me solaire?", a: ["7", "8", "9"], c: 1},
                        {q: "√âl√©ment 'Au'?", a: ["Argent", "Aluminium", "Or"], c: 2},
                        {q: "Oscars Titanic?", a: ["9", "11", "13"], c: 1},
                        {q: "C≈ìurs poulpe?", a: ["1", "2", "3"], c: 2},
                        {q: "Pays plus grand?", a: ["Chine", "USA", "Russie"], c: 2}
                    ],
                    tabu: [
                        {w: "Orgasme", f: ["Apog√©e", "Plaisir", "Jouir"]}, {w: "Pr√©servatif", f: ["Capote", "Protection", "S√ªr"]},
                        {w: "Tinder", f: ["Rencontre", "Swipe", "Match"]}, {w: "Kamasutra", f: ["Position", "Livre", "Sexe"]},
                        {w: "Striptease", f: ["D√©shabiller", "Danse", "Club"]}, {w: "Plan cul", f: ["Sexe", "Nuit", "Inconnu"]},
                        {w: "Viagra", f: ["Puissance", "Pilule", "Dur"]}, {w: "Aphrodisiaque", f: ["D√©sir", "Drogue", "Nourriture"]},
                        {w: "Plan √† trois", f: ["Sexe", "Trois", "Groupe"]}, {w: "Bondage", f: ["Corde", "Attacher", "BDSM"]}
                    ],
                    z: ["Fantasme sexuel secret?", "Avec qui ici coucherais-tu?", "Acte plus os√©?", "Dernier r√™ve sexe?", 
                        "Quelle partie t'excite?", "Position pr√©f√©r√©e?", "Moment sex honteux?", "Dom ou soumis?",
                        "D√©j√† tromp√©?", "Derni√®re fois sexe?", "Plus gros turn-off?", "D√©j√† film√©?",
                        "D√©j√† ext√©rieur?", "Jouet pr√©f√©r√©?", "M√™me genre?"]
                },
                chaos: [
                    {n: "√âCHANGE IDENTIT√â", t: "√âchange ton identit√©!", d: "Tu joues comme personne droite.", e: "swap"},
                    {n: "PARI DOUBLE", t: "Tout compte double!", d: "Strips doubl√©s.", e: "double"},
                    {n: "BLACKJACK FORC√â", t: "Seul Blackjack compte!", d: "Perte = -3 Strips", e: "bjforced"},
                    {n: "√âCHANGE R√îLES", t: "Gauche devient Droite", d: "Directions invers√©es.", e: "reverse"},
                    {n: "CHACUN POUR SOI", t: "Chacun pour soi!", d: "Manche suivante: perdant strip.", e: "allvsall"}
                ]
            },
            it: {
                subtitle: "Edizione Alto Rischio",
                tag1: "‚ö° 4 Modalit√†",
                tag2: "üé≤ Blackjack",
                tag3: "üî• Rischio x2",
                newGame: "Nuovo Gioco",
                rules: "Regole",
                back: "Indietro",
                players: "GIOCATORI",
                start: "Inizia",
                types: { action: "‚ö° Azione", quiz: "üß† Quiz", tabu: "üö´ Parola Vietata", z: "üî• Posto Caldo", chaos: "‚ö†Ô∏è Jolly" },
                winner: "VINCITORE",
                newRound: "Nuovo Round",
                betTitle: "Scommetti",
                betInfo: "Ti rimane solo 1 indumento!<br>Scommetti per restare.",
                betPrompt: "Incolla link video...",
                chooseRounds: "Scegli numero round",
                confirmBet: "Conferma",
                fold: "Fold",
                challengeTitle: "Sfida Scommessa",
                challengeInfo: "ha scommesso.<br>Sfidalo.",
                currentBet: "Scommessa attuale:",
                play1: "1 Round<br>Gioca",
                play3: "3 Round<br>Rischio x3",
                decline: "Rifiuta",
                overbidTitle: "Rilancia",
                overbidInfo: "+5 Secondi = +1 Indumento<br>Ogni 5s extra = 1 Bonus",
                raise: "Rilancia",
                cancel: "Annulla",
                bjRules: "Chi si avvicina a 21 vince",
                you: "TU",
                stand: "STAI",
                hit: "CARTA",
                round: "Round",
                strip: "Strip (-1)",
                success: "Fatto ‚úì",
                next: "Avanti ‚Üí",
                potActive: "POT ATTIVO",
                bjMode: "Modalit√† Blackjack",
                bjSubtitle: "Gioco di Carte Alto Rischio",
                bjDealer: "BANCA",
                bjPlayer: "TU",
                bjStand: "STAI",
                bjHit: "CARTA",
                bjExit: "Uscita",
                bjPlayAgain: "Gioca Ancora",
                bjWin: "Vittoria!",
                bjLose: "Sconfitta!",
                bjDraw: "Pareggio!",
                rulesText: `FUNKENFLUG - Edizione Alto Rischio

REGOLE:
‚Ä¢ 5 indumenti per giocatore
‚Ä¢ Lancia per compiti: Azione, Quiz, Parola Vietata, Posto Caldo
‚Ä¢ Jolly per sorprese

BLACKJACK:
‚Ä¢ Gioca contro la banca o altri
‚Ä¢ Chi si avvicina a 21 vince
‚Ä¢ Asso vale 1 o 11

SISTEMA POT:
‚Ä¢ Ultimo indumento: Scommessa con link video
‚Ä¢ 10s per indumento se perdi
‚Ä¢ Sfida possibile (1x o 3x round)

Rilancio: +5s = +1 Bonus`,
                decks: {
                    actions: [
                        {t: "Scambia maglia sinistra", i: 3}, {t: "Fatti solleticare 30s", i: 2},
                        {t: "Sussurra un segreto", i: 4}, {t: "Bevi senza mani", i: 3},
                        {t: "Complimento spinto", i: 2}, {t: "Togli qualcosa", i: 5},
                        {t: "Verit√† o Strip?", i: 4}, {t: "Fai spot sexy", i: 3},
                        {t: "Massaggia spalle", i: 2}, {t: "Recita scena porno", i: 5},
                        {t: "Indovina chi ti tocca", i: 3}, {t: "Scambia posti", i: 2},
                        {t: "Faccia dirty talk", i: 3}, {t: "Mangia ghiaccio d√©collet√©", i: 4},
                        {t: "Storia sex imbarazzante", i: 4}, {t: "Bacio appassionato", i: 3},
                        {t: "Lecca cioccolato pancia", i: 5}, {t: "Striptease (30s)", i: 5},
                        {t: "Scambia tutto con destra", i: 4}, {t: "Body-scan sinistra", i: 4}
                    ],
                    quiz: [
                        {q: "Passi al giorno (media)?", a: ["3.000", "10.000", "15.000"], c: 1},
                        {q: "Organo interno pi√π grande?", a: ["Cuore", "Fegato", "Polmone"], c: 1},
                        {q: "Denti adulti?", a: ["28", "32", "36"], c: 1},
                        {q: "Primo iPhone anno?", a: ["2005", "2007", "2009"], c: 1},
                        {q: "Capitale Australia?", a: ["Sydney", "Melbourne", "Canberra"], c: 2},
                        {q: "Pianeti sistema solare?", a: ["7", "8", "9"], c: 1},
                        {q: "Elemento 'Au'?", a: ["Argento", "Alluminio", "Oro"], c: 2},
                        {q: "Oscar Titanic?", a: ["9", "11", "13"], c: 1},
                        {q: "Cuori polpo?", a: ["1", "2", "3"], c: 2},
                        {q: "Paese pi√π grande?", a: ["Cina", "USA", "Russia"], c: 2}
                    ],
                    tabu: [
                        {w: "Orgasmo", f: ["Climax", "Piacere", "Venire"]}, {w: "Preservativo", f: ["Gomma", "Protezione", "Sicuro"]},
                        {w: "Tinder", f: ["Appuntamenti", "Swipe", "Match"]}, {w: "Kamasutra", f: ["Posizione", "Libro", "Sesso"]},
                        {w: "Striptease", f: ["Spogliare", "Danza", "Club"]}, {w: "Avventura", f: ["Sesso", "Notte", "Sconosciuto"]},
                        {w: "Viagra", f: ["Potenza", "Pillola", "Duro"]}, {w: "Afrodisiaco", f: ["Desiderio", "Droga", "Cibo"]},
                        {w: "Trio", f: ["Sesso", "Tre", "Gruppo"]}, {w: "Bondage", f: ["Corda", "Legare", "BDSM"]}
                    ],
                    z: ["Fantasia sessuale segreta?", "Con chi dormiresti qui?", "Azione pi√π audace?", "Ultimo sogno erotico?", 
                        "Che parte ti eccita?", "Posizione preferita?", "Momento sess imbarazzante?", "Dom o sottomesso?",
                        "Mai tradito?", "Quando ultimo sesso?", "Cosa ti spegne?", "Mai fatto video?",
                        "Mai all'aperto?", "Giocattolo preferito?", "Mai stesso genere?"]
                },
                chaos: [
                    {n: "SCAMBIO IDENTIT√Ä", t: "Scambia identit√†!", d: "Giochi come persona destra.", e: "swap"},
                    {n: "SCOMMESSA DOPPIA", t: "Tutto conta doppio!", d: "Strip raddoppiati.", e: "double"},
                    {n: "BLACKJACK FORZATO", t: "Solo Blackjack conta!", d: "Perdita = -3 Strip", e: "bjforced"},
                    {n: "SCAMBIO RUOLI", t: "Sinistra √® Destra", d: "Direzioni invertite.", e: "reverse"},
                    {n: "OGNIUNO PER S√â", t: "Ognuno per s√©!", d: "Prossimo round: perdente strip.", e: "allvsall"}
                ]
            },
            pt: {
                subtitle: "Edi√ß√£o Alto Risco",
                tag1: "‚ö° 4 Modos",
                tag2: "üé≤ Blackjack",
                tag3: "üî• Risco x2",
                newGame: "Novo Jogo",
                rules: "Regras",
                back: "Voltar",
                players: "JOGADORES",
                start: "Iniciar",
                types: { action: "‚ö° A√ß√£o", quiz: "üß† Quiz", tabu: "üö´ Palavra Proibida", z: "üî• Assento Quente", chaos: "‚ö†Ô∏è Coringa" },
                winner: "VENCEDOR",
                newRound: "Nova Rodada",
                betTitle: "Apostar",
                betInfo: "S√≥ resta 1 pe√ßa!<br>Aposte para ficar.",
                betPrompt: "Cole link do v√≠deo...",
                chooseRounds: "Escolha n√∫mero de rodadas",
                confirmBet: "Confirmar",
                fold: "Desistir",
                challengeTitle: "Desafiar Aposta",
                challengeInfo: "apostou.<br>Desafie-o.",
                currentBet: "Aposta atual:",
                play1: "1 Rodada<br>Jogar",
                play3: "3 Rodadas<br>Risco x3",
                decline: "Recusar",
                overbidTitle: "Aumentar",
                overbidInfo: "+5 Segundos = +1 Pe√ßa<br>Cada 5s extra = 1 B√¥nus",
                raise: "Aumentar",
                cancel: "Cancelar",
                bjRules: "Quem chegar perto de 21 ganha",
                you: "VOC√ä",
                stand: "PARAR",
                hit: "COMPRAR",
                round: "Rodada",
                strip: "Tirar (-1)",
                success: "Feito ‚úì",
                next: "Pr√≥ximo ‚Üí",
                potActive: "POT ATIVO",
                bjMode: "Modo Blackjack",
                bjSubtitle: "Jogo de Cartas Alto Risco",
                bjDealer: "BANCA",
                bjPlayer: "VOC√ä",
                bjStand: "PARAR",
                bjHit: "COMPRAR",
                bjExit: "Sair",
                bjPlayAgain: "Jogar Novamente",
                bjWin: "Voc√™ Ganhou!",
                bjLose: "Voc√™ Perdeu!",
                bjDraw: "Empate!",
                rulesText: `FUNKENFLUG - Edi√ß√£o Alto Risco

REGRAS:
‚Ä¢ 5 pe√ßas de roupa por jogador
‚Ä¢ Role para tarefas: A√ß√£o, Quiz, Palavra Proibida, Assento Quente
‚Ä¢ Coringas para surpresas

BLACKJACK:
‚Ä¢ Jogue contra a banca ou outros
‚Ä¢ Quem chegar perto de 21 ganha
‚Ä¢ √Ås vale 1 ou 11

SISTEMA POT:
‚Ä¢ √öltima pe√ßa: Aposta com link de v√≠deo
‚Ä¢ 10s por pe√ßa se perder
‚Ä¢ Desafio poss√≠vel (1x ou 3x rodadas)

Aumentar: +5s = +1 B√¥nus`,
                decks: {
                    actions: [
                        {t: "Troca camisa esquerda", i: 3}, {t: "Seja faz c√≥cegas 30s", i: 2},
                        {t: "Sussurre um segredo", i: 4}, {t: "Beba sem m√£os", i: 3},
                        {t: "Elogio ousado", i: 2}, {t: "Tire algo", i: 5},
                        {t: "Verdade ou Strip?", i: 4}, {t: "Atue comercial sexy", i: 3},
                        {t: "Massageie ombros", i: 2}, {t: "Atue cena porn√¥", i: 5},
                        {t: "Adivinhe quem toca", i: 3}, {t: "Troque lugares", i: 2},
                        {t: "Cara dirty talk", i: 3}, {t: "Coma gelo do decote", i: 4},
                        {t: "Hist√≥ria sex vergonhosa", i: 4}, {t: "Beijo apaixonado", i: 3},
                        {t: "Lamba chocolate barriga", i: 5}, {t: "Striptease (30s)", i: 5},
                        {t: "Troque tudo direita", i: 4}, {t: "Body-scan esquerda", i: 4}
                    ],
                    quiz: [
                        {q: "Passos por dia (m√©dia)?", a: ["3.000", "10.000", "15.000"], c: 1},
                        {q: "Maior √≥rg√£o interno?", a: ["Cora√ß√£o", "F√≠gado", "Pulm√£o"], c: 1},
                        {q: "Dentes adultos?", a: ["28", "32", "36"], c: 1},
                        {q: "Primeiro iPhone ano?", a: ["2005", "2007", "2009"], c: 1},
                        {q: "Capital da Austr√°lia?", a: ["Sydney", "Melbourne", "Canberra"], c: 2},
                        {q: "Planetas sistema solar?", a: ["7", "8", "9"], c: 1},
                        {q: "Elemento 'Au'?", a: ["Prata", "Alum√≠nio", "Ouro"], c: 2},
                        {q: "Oscars Titanic?", a: ["9", "11", "13"], c: 1},
                        {q: "Cora√ß√µes polvo?", a: ["1", "2", "3"], c: 2},
                        {q: "Maior pa√≠s?", a: ["China", "USA", "R√∫ssia"], c: 2}
                    ],
                    tabu: [
                        {w: "Orgasmo", f: ["Cl√≠max", "Prazer", "Gozar"]}, {w: "Preservativo", f: ["Camisinha", "Prote√ß√£o", "Seguro"]},
                        {w: "Tinder", f: ["Encontros", "Swipe", "Match"]}, {w: "Kamasutra", f: ["Posi√ß√£o", "Livro", "Sexo"]},
                        {w: "Striptease", f: ["Tirar roupa", "Dan√ßa", "Boate"]}, {w: "Aventura", f: ["Sexo", "Noite", "Desconhecido"]},
                        {w: "Viagra", f: ["Pot√™ncia", "P√≠lula", "Duro"]}, {w: "Afrodis√≠aco", f: ["Desejo", "Droga", "Comida"]},
                        {w: "M√©nage", f: ["Sexo", "Tr√™s", "Grupo"]}, {w: "Bondage", f: ["Corda", "Amarrar", "BDSM"]}
                    ],
                    z: ["Fantasia sexual secreta?", "Com quem dormiria aqui?", "Ato mais ousado?", "√öltimo sonho er√≥tico?", 
                        "Qual parte te excita?", "Posi√ß√£o favorita?", "Momento sex vergonhoso?", "Dom ou submisso?",
                        "J√° traiu?", "Quando foi √∫ltima vez?", "O que te desliga?", "J√° fez v√≠deo?",
                        "J√° ao ar livre?", "Brinquedo favorito?", "J√° mesmo g√™nero?"]
                },
                chaos: [
                    {n: "TROCA IDENTIDADE", t: "Troque sua identidade!", d: "Voc√™ joga como pessoa direita.", e: "swap"},
                    {n: "APOSTA DUPLA", t: "Tudo conta dobro!", d: "Strips dobrados.", e: "double"},
                    {n: "BLACKJACK FOR√áADO", t: "S√≥ Blackjack conta!", d: "Perda = -3 Strips", e: "bjforced"},
                    {n: "TROCA DE PAPEL", t: "Esquerda √© Direita", d: "Dire√ß√µes invertidas.", e: "reverse"},
                    {n: "CADA UM POR SI", t: "Cada um por si!", d: "Pr√≥xima rodada: perdedor strip.", e: "allvsall"}
                ]
            },
            nl: {
                subtitle: "High Stakes Editie",
                tag1: "‚ö° 4 Modi",
                tag2: "üé≤ Blackjack",
                tag3: "üî• Risico x2",
                newGame: "Nieuw Spel",
                rules: "Regels",
                back: "Terug",
                players: "SPELERS",
                start: "Start",
                types: { action: "‚ö° Actie", quiz: "üß† Quiz", tabu: "üö´ Verboden Woord", z: "üî• Hete Stoel", chaos: "‚ö†Ô∏è Joker" },
                winner: "WINNAAR",
                newRound: "Nieuwe Ronde",
                betTitle: "Inzetten",
                betInfo: "Je hebt nog maar 1 kledingstuk!<br>Zet in om te blijven.",
                betPrompt: "Plak video link...",
                chooseRounds: "Kies aantal rondes",
                confirmBet: "Bevestigen",
                fold: "Fold",
                challengeTitle: "Uitdagen",
                challengeInfo: "heeft ingezet.<br>Daag uit.",
                currentBet: "Huidige inzet:",
                play1: "1 Ronde<br>Spelen",
                play3: "3 Rondes<br>Risico x3",
                decline: "Afwijzen",
                overbidTitle: "Verhogen",
                overbidInfo: "+5 Seconden = +1 Kledingstuk<br>Elke extra 5s = 1 Bonus",
                raise: "Verhogen",
                cancel: "Annuleren",
                bjRules: "Dichtst bij 21 wint",
                you: "JIJ",
                stand: "PASSEN",
                hit: "KAART",
                round: "Ronde",
                strip: "Uit (-1)",
                success: "Klaar ‚úì",
                next: "Volgende ‚Üí",
                potActive: "POT ACTIEF",
                bjMode: "Blackjack Modus",
                bjSubtitle: "Kaartspel High Stakes",
                bjDealer: "BANK",
                bjPlayer: "JIJ",
                bjStand: "PASSEN",
                bjHit: "KAART",
                bjExit: "Afsluiten",
                bjPlayAgain: "Opnieuw Spelen",
                bjWin: "Gewonnen!",
                bjLose: "Verloren!",
                bjDraw: "Gelijkspel!",
                rulesText: `FUNKENFLUG - High Stakes Editie

REGELS:
‚Ä¢ 5 kledingstukken per speler
‚Ä¢ Rol voor taken: Actie, Quiz, Verboden Woord, Hete Stoel
‚Ä¢ Jokers voor verrassingen

BLACKJACK:
‚Ä¢ Speel tegen de bank of anderen
‚Ä¢ Dichtst bij 21 wint
‚Ä¢ Aas telt als 1 of 11

POT SYSTEEM:
‚Ä¢ Laatste kledingstuk: Inzet met video link
‚Ä¢ 10s per stuk bij verlies
‚Ä¢ Uitdaging mogelijk (1x of 3x rondes)

Verhogen: +5s = +1 Bonus`,
                decks: {
                    actions: [
                        {t: "Ruil shirt links", i: 3}, {t: "Laat je 30s kietelen", i: 2},
                        {t: "Fluister geheim", i: 4}, {t: "Drink zonder handen", i: 3},
                        {t: "Stoute compliment", i: 2}, {t: "Doe iets uit", i: 5},
                        {t: "Waarheid of Strip?", i: 4}, {t: "Doe sexy reclame", i: 3},
                        {t: "Massage schouders", i: 2}, {t: "Speel porno sc√®ne", i: 5},
                        {t: "Raad wie je aanraakt", i: 3}, {t: "Wissel plaats", i: 2},
                        {t: "Dirty talk gezicht", i: 3}, {t: "Eet ijsblokje decollet√©", i: 4},
                        {t: "G√™nant sex verhaal", i: 4}, {t: "Hartstochtelijke kus", i: 3},
                        {t: "Lik chocolade buik", i: 5}, {t: "Striptease (30s)", i: 5},
                        {t: "Ruil alles rechts", i: 4}, {t: "Body-scan links", i: 4}
                    ],
                    quiz: [
                        {q: "Stappen per dag (gemiddeld)?", a: ["3.000", "10.000", "15.000"], c: 1},
                        {q: "Grootste orgaan?", a: ["Hart", "Lever", "Long"], c: 1},
                        {q: "Tanden volwassene?", a: ["28", "32", "36"], c: 1},
                        {q: "Eerste iPhone jaar?", a: ["2005", "2007", "2009"], c: 1},
                        {q: "Hoofdstad Australi√´?", a: ["Sydney", "Melbourne", "Canberra"], c: 2},
                        {q: "Planeten zonnestelsel?", a: ["7", "8", "9"], c: 1},
                        {q: "Element 'Au'?", a: ["Zilver", "Aluminium", "Goud"], c: 2},
                        {q: "Oscars Titanic?", a: ["9", "11", "13"], c: 1},
                        {q: "Harten octopus?", a: ["1", "2", "3"], c: 2},
                        {q: "Grootste land?", a: ["China", "USA", "Rusland"], c: 2}
                    ],
                    tabu: [
                        {w: "Orgasme", f: ["Hoogtepunt", "Plezier", "Klaarkomen"]}, {w: "Condoom", f: ["Rubber", "Bescherming", "Veilig"]},
                        {w: "Tinder", f: ["Daten", "Swipe", "Match"]}, {w: "Kamasutra", f: ["Positie", "Boek", "Seks"]},
                        {w: "Striptease", f: ["Uitkleden", "Dans", "Club"]}, {w: "One-night-stand", f: ["Seks", "Nacht", "Vreemde"]},
                        {w: "Viagra", f: ["Potentie", "Pil", "Hard"]}, {w: "Aphrodisiacum", f: ["Lust", "Drug", "Eten"]},
                        {w: "Drie√´nd", f: ["Seks", "Drie", "Groep"]}, {w: "Bondage", f: ["Touw", "Vastbinden", "BDSM"]}
                    ],
                    z: ["Geheime seksuele fantasie?", "Met wie zou je hier slapen?", "Stoutste daad?", "Laatste seks droom?", 
                        "Welk lichaamsdeel opwindend?", "Favoriete positie?", "G√™nantste seks moment?", "Dom of onderdanig?",
                        "Ooit bedrogen?", "Wanneer laatste keer?", "Grootste afknapper?", "Ooit video gemaakt?",
                        "Ooit buiten?", "Favoriete speeltje?", "Ooit zelfde geslacht?"]
                },
                chaos: [
                    {n: "IDENTITEITSWISSEL", t: "Ruil identiteit!", d: "Je speelt als persoon rechts.", e: "swap"},
                    {n: "DUBBELE INZET", t: "Alles telt dubbel!", d: "Strips verdubbeld.", e: "double"},
                    {n: "VERPLICHT BLACKJACK", t: "Alleen Blackjack telt!", d: "Verlies = -3 Strips", e: "bjforced"},
                    {n: "ROLLENWISSEL", t: "Links wordt Rechts", d: "Richtingen verwisseld.", e: "reverse"},
                    {n: "IEDEREEN TEGEN IEDEREEN", t: "Iedereen tegen iedereen!", d: "Volgende ronde: verliezer strip.", e: "allvsall"}
                ]
            }
        };

        class FlowController {
            constructor(lang) {
                this.lang = lang;
                this.energy = 50;
                this.history = [];
                this.chaosCooldown = 0;
                this.lastCategories = [];
                this.tensionPeaks = 0;
            }

            selectNextCategory(forceChaos = false) {
                if (forceChaos || (this.chaosCooldown >= 3 && Math.random() < this.getChaosChance())) {
                    this.chaosCooldown = 0;
                    this.energy = Math.min(100, this.energy + 30);
                    this.tensionPeaks++;
                    return 'chaos';
                }
                this.chaosCooldown++;

                const categories = ['action', 'quiz', 'tabu', 'z'];
                const available = categories.filter(c => !this.lastCategories.includes(c));
                const pool = available.length > 0 ? available : categories;
                
                let weights = {};
                pool.forEach(c => {
                    if (this.energy > 75) {
                        weights[c] = (c === 'quiz' || c === 'tabu') ? 3 : 1;
                    } else if (this.energy < 30) {
                        weights[c] = (c === 'action' || c === 'z') ? 3 : 1;
                    } else {
                        weights[c] = 2;
                    }
                });

                const result = this.weightedRandom(pool, weights);
                this.updateEnergy(result);
                this.lastCategories.push(result);
                if (this.lastCategories.length > 2) this.lastCategories.shift();
                
                return result;
            }

            getChaosChance() {
                if (this.energy > 70) return 0.4;
                if (this.energy < 30) return 0.1;
                return 0.25;
            }

            updateEnergy(category) {
                const changes = {
                    'action': +15, 'quiz': -10, 'tabu': -5, 'z': +20, 'chaos': +30
                };
                this.energy = Math.max(0, Math.min(100, this.energy + (changes[category] || 0)));
            }

            weightedRandom(items, weights) {
                const total = Object.values(weights).reduce((a,b) => a+b, 0);
                let random = Math.random() * total;
                for (let item of items) {
                    random -= weights[item];
                    if (random <= 0) return item;
                }
                return items[0];
            }

            addToHistory(type, task) {
                this.history.push({type, task, energy: this.energy, time: Date.now()});
                if (this.history.length > 20) this.history.shift();
            }

            getUniqueTask(category, deck) {
                const recentTasks = this.history.slice(-8).map(h => {
                    if (typeof h.task === 'string') return h.task;
                    return h.task?.t || h.task?.q || h.task?.w || '';
                });
                let attempts = 0;
                let task;
                do {
                    task = this.getRandomFromDeck(category, deck);
                    attempts++;
                } while (recentTasks.includes(this.taskToString(task)) && attempts < 10);
                return task;
            }

            taskToString(task) {
                if (typeof task === 'string') return task;
                return task?.t || task?.q || task?.w || JSON.stringify(task);
            }

            getRandomFromDeck(cat, deck) {
                const arr = deck[cat === 'z' ? 'z' : cat === 'action' ? 'actions' : cat === 'quiz' ? 'quiz' : 'tabu'];
                return arr[Math.floor(Math.random() * arr.length)];
            }
        }

        class Game {
            constructor() {
                this.lang = 'de';
                this.flow = new FlowController(this.lang);
                this.session = null;
                this.pot = null;
                this.bj = null;
                this.betRounds = 1;
                this.overbidAmount = 0;
                this.blackjackGame = null;
                this.init();
            }

            init() {
                // Sprache aus localStorage laden falls vorhanden
                const savedLang = localStorage.getItem('funkenflug-lang');
                if (savedLang && I18N[savedLang]) {
                    this.setLanguage(savedLang);
                } else {
                    this.updateUILanguage();
                }
            }

            setLanguage(lang) {
                this.lang = lang;
                localStorage.setItem('funkenflug-lang', lang);
                this.flow = new FlowController(lang);
                this.updateUILanguage();
                document.getElementById('overlay-language').classList.remove('active');
                document.getElementById('overlay-start').classList.add('active');
            }

            showLanguage() {
                document.querySelectorAll('.overlay').forEach(o => o.classList.remove('active'));
                document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
                document.querySelectorAll('.game-over-modal').forEach(m => m.classList.remove('active'));
                document.getElementById('overlay-language').classList.add('active');
            }

            updateUILanguage() {
                const t = I18N[this.lang];
                document.getElementById('langSubtitle').textContent = this.lang === 'de' ? 'W√§hle deine Sprache' : 'Choose your language';
                document.getElementById('startSubtitle').textContent = t.subtitle;
                document.getElementById('tag1').textContent = t.tag1;
                document.getElementById('tag2').textContent = t.tag2;
                document.getElementById('tag3').textContent = t.tag3;
                document.getElementById('btnNewGame').textContent = t.newGame;
                document.getElementById('btnBjMode').textContent = `üé∞ ${t.bjMode || 'Blackjack'}`;
                document.getElementById('btnRules').textContent = t.rules;
                document.getElementById('lobbyTitle').textContent = t.players;
                document.getElementById('btnStart').textContent = t.start;
                document.getElementById('btnBack').textContent = t.back;
                document.getElementById('type-action').textContent = t.types.action;
                document.getElementById('type-quiz').textContent = t.types.quiz;
                document.getElementById('type-tabu').textContent = t.types.tabu;
                document.getElementById('type-z').textContent = t.types.z;
                document.getElementById('type-chaos').textContent = t.types.chaos;
                document.getElementById('winnerLabel').textContent = t.winner;
                document.getElementById('btnNewRound').textContent = t.newRound;
                document.getElementById('betTitle').textContent = t.betTitle;
                document.getElementById('betInfo').innerHTML = t.betInfo;
                document.getElementById('videoUrl').placeholder = t.betPrompt;
                document.getElementById('betSummary').textContent = t.chooseRounds;
                document.getElementById('btnConfirmBet').textContent = t.confirmBet;
                document.getElementById('btnFold').textContent = t.fold;
                document.getElementById('challengeTitle').textContent = t.challengeTitle;
                document.getElementById('challengeInfo').innerHTML = t.challengeInfo;
                document.getElementById('currentBetLabel').textContent = t.currentBet;
                document.getElementById('btnChallenge1').innerHTML = t.play1;
                document.getElementById('btnDecline').textContent = t.decline;
                document.getElementById('overbidTitle').textContent = t.overbidTitle;
                document.getElementById('overbidInfo').innerHTML = t.overbidInfo;
                document.getElementById('btnConfirmOverbid').textContent = t.raise;
                document.getElementById('btnCancelOverbid').textContent = t.cancel;
                document.getElementById('bjChallengeRules').textContent = t.bjRules;
                document.getElementById('bjYouLabel').textContent = t.you;
                document.getElementById('btnStandChallenge').textContent = t.stand;
                document.getElementById('btnHitChallenge').textContent = t.hit;
                document.getElementById('btnStrip').textContent = t.strip;
                document.getElementById('btnSuccess').textContent = t.success;
                document.getElementById('btnNext').textContent = t.next;
                document.getElementById('potText').textContent = t.potActive;
                
                // Blackjack Mode √úbersetzungen
                document.getElementById('bjModeSubtitle').textContent = t.bjSubtitle || 'High Stakes Card Battle';
                document.getElementById('bjDealerLabel').textContent = t.bjDealer || 'DEALER';
                document.getElementById('bjPlayerLabel').textContent = t.bjPlayer || 'YOU';
                document.getElementById('bjRulesText').textContent = t.bjRules || 'Closest to 21 wins ‚Ä¢ Ace = 1 or 11';
                document.getElementById('btnBjStand').textContent = t.bjStand || 'STAND';
                document.getElementById('btnBjHit').textContent = t.bjHit || 'HIT';
                document.getElementById('btnBjExit').textContent = t.bjExit || 'Exit';
            }

            showStart() {
                document.querySelectorAll('.overlay').forEach(o => o.classList.remove('active'));
                document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
                document.getElementById('overlay-start').classList.add('active');
                document.getElementById('playerQueue').classList.add('hidden');
                document.getElementById('fabContainer').classList.remove('active');
                document.getElementById('potIndicator').classList.remove('active');
            }

            startBlackjackMode() {
                // Initialisiere Standalone Blackjack gegen die Bank
                this.blackjackGame = {
                    playerHand: [],
                    dealerHand: [],
                    deck: this.createDeck(),
                    standing: false,
                    gameOver: false
                };
                
                // Karten austeilen
                this.blackjackGame.playerHand.push(this.blackjackGame.deck.pop(), this.blackjackGame.deck.pop());
                this.blackjackGame.dealerHand.push(this.blackjackGame.deck.pop(), this.blackjackGame.deck.pop());
                
                document.querySelectorAll('.overlay').forEach(o => o.classList.remove('active'));
                document.querySelectorAll('.modal').forEach(m => m.classList.remove('active'));
                document.getElementById('overlay-blackjack').classList.add('active');
                
                // Pr√ºfe auf Blackjack sofort
                const playerScore = this.calcHand(this.blackjackGame.playerHand);
                if (playerScore === 21) {
                    setTimeout(() => this.blackjackStand(), 500);
                }
                
                this.updateBlackjackUI();
            }

            updateBlackjackUI() {
                if (!this.blackjackGame) return;
                
                const render = (hand, hideFirst = false) => {
                    return hand.map((c, i) => {
                        if (hideFirst && i === 0) return '<div class="bj-card hidden"></div>';
                        const isRed = c.s === '‚ô•' || c.s === '‚ô¶';
                        return `<div class="bj-card ${isRed ? 'red' : ''}">${c.l}${c.s}</div>`;
                    }).join('');
                };

                const playerScore = this.calcHand(this.blackjackGame.playerHand);
                const dealerScore = this.calcHand(this.blackjackGame.dealerHand);
                
                document.getElementById('bjPlayerHandDisplay').innerHTML = render(this.blackjackGame.playerHand);
                document.getElementById('bjPlayerScoreDisplay').innerText = playerScore;
                
                // Zeige Dealer-Karten (erste verdeckt wenn Spiel l√§uft)
                document.getElementById('bjDealerHand').innerHTML = render(
                    this.blackjackGame.dealerHand, 
                    !this.blackjackGame.standing && !this.blackjackGame.gameOver
                );
                document.getElementById('bjDealerScore').innerText = 
                    (this.blackjackGame.standing || this.blackjackGame.gameOver) ? dealerScore : '?';
            }

            blackjackHit() {
                if (!this.blackjackGame || this.blackjackGame.standing || this.blackjackGame.gameOver) return;
                
                this.blackjackGame.playerHand.push(this.blackjackGame.deck.pop());
                this.updateBlackjackUI();
                
                const score = this.calcHand(this.blackjackGame.playerHand);
                if (score > 21) {
                    this.blackjackGame.gameOver = true;
                    setTimeout(() => {
                        this.showBlackjackResult(false, "Bust! Over 21");
                    }, 500);
                } else if (score === 21) {
                    // Auto-stand bei 21
                    setTimeout(() => this.blackjackStand(), 300);
                }
            }

            blackjackStand() {
                if (!this.blackjackGame || this.blackjackGame.standing || this.blackjackGame.gameOver) return;
                
                this.blackjackGame.standing = true;
                this.updateBlackjackUI();
                
                // Dealer zieht
                setTimeout(() => this.dealerTurn(), 800);
            }

            dealerTurn() {
                if (!this.blackjackGame) return;
                
                let dealerScore = this.calcHand(this.blackjackGame.dealerHand);
                
                // Dealer zieht bis 17
                while (dealerScore < 17) {
                    this.blackjackGame.dealerHand.push(this.blackjackGame.deck.pop());
                    dealerScore = this.calcHand(this.blackjackGame.dealerHand);
                }
                
                this.updateBlackjackUI();
                
                setTimeout(() => {
                    this.resolveBlackjack();
                }, 1000);
            }

            resolveBlackjack() {
                const playerScore = this.calcHand(this.blackjackGame.playerHand);
                const dealerScore = this.calcHand(this.blackjackGame.dealerHand);
                
                let win = false;
                let message = "";
                
                if (playerScore > 21) {
                    win = false;
                    message = `Bust! ${playerScore} vs ${dealerScore}`;
                } else if (dealerScore > 21) {
                    win = true;
                    message = `Dealer bust! ${dealerScore}`;
                } else if (playerScore > dealerScore) {
                    win = true;
                    message = `${playerScore} vs ${dealerScore}`;
                } else if (playerScore < dealerScore) {
                    win = false;
                    message = `${playerScore} vs ${dealerScore}`;
                } else {
                    // Unentschieden
                    this.showBlackjackResult(null, `Push! ${playerScore} = ${dealerScore}`);
                    return;
                }
                
                this.showBlackjackResult(win, message);
            }

            showBlackjackResult(win, message) {
                const t = I18N[this.lang];
                const icon = win === null ? 'ü§ù' : (win ? 'üèÜ' : 'üíî');
                const title = win === null ? t.bjDraw : (win ? t.bjWin : t.bjLose);
                
                document.getElementById('bjResultIcon').textContent = icon;
                document.getElementById('bjResultTitle').textContent = title;
                document.getElementById('bjResultMessage').textContent = message;
                
                document.getElementById('overlay-bj-gameover').classList.add('active');
            }

            restartBlackjack() {
                document.getElementById('overlay-bj-gameover').classList.remove('active');
                this.startBlackjackMode();
            }

            endBlackjackMode() {
                document.getElementById('overlay-blackjack').classList.remove('active');
                document.getElementById('overlay-bj-gameover').classList.remove('active');
                document.getElementById('overlay-start').classList.add('active');
                this.blackjackGame = null;
            }

            calcHand(hand) {
                let sum = 0, aces = 0;
                for (let c of hand) {
                    sum += c.v;
                    if (c.l === 'A') aces++;
                }
                while (sum > 21 && aces > 0) {
                    sum -= 10;
                    aces--;
                }
                return sum;
            }

            createDeck() {
                const suits = ['‚ô†', '‚ô•', '‚ô¶', '‚ô£'];
                const values = [
                    {v: 2, l: '2'}, {v: 3, l: '3'}, {v: 4, l: '4'}, {v: 5, l: '5'},
                    {v: 6, l: '6'}, {v: 7, l: '7'}, {v: 8, l: '8'}, {v: 9, l: '9'},
                    {v: 10, l: '10'}, {v: 10, l: 'J'}, {v: 10, l: 'Q'},
                    {v: 10, l: 'K'}, {v: 11, l: 'A'}
                ];
                let deck = [];
                for (let s of suits) {
                    for (let v of values) {
                        deck.push({...v, s: s});
                    }
                }
                for (let i = deck.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [deck[i], deck[j]] = [deck[j], deck[i]];
                }
                return deck;
            }

            showLobby() {
                this.session = {players: [], current: 0, round: 0, potActive: false};
                this.addPlayer();
                this.addPlayer();
                document.querySelectorAll('.overlay').forEach(o => o.classList.remove('active'));
                document.getElementById('overlay-lobby').classList.add('active');
            }

            addPlayer() {
                if (this.session.players.length >= 8) return;
                const id = this.session.players.length;
                const t = I18N[this.lang];
                this.session.players.push({
                    id: id,
                    name: t.players + ' ' + (id + 1), 
                    clothes: 5, 
                    out: false,
                    betMade: false,
                    bonusItems: 0
                });
                this.renderLobby();
            }

            renderLobby() {
                const div = document.getElementById('lobbyList');
                div.innerHTML = '';
                this.session.players.forEach((p, i) => {
                    div.innerHTML += `
                        <div style="display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.1);">
                            <div style="width:36px;height:36px;background:var(--gold);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#000;font-weight:700;font-size:14px;">${p.name[0]}</div>
                            <input value="${p.name}" onchange="game.session.players[${i}].name=this.value" 
                                style="flex:1;background:transparent;border:none;color:#fff;font-size:16px;outline:none;">
                            ${this.session.players.length > 2 ? 
                                `<button onclick="game.session.players.splice(${i},1);game.renderLobby()" 
                                    style="background:none;border:none;color:var(--danger);font-size:20px; width:36px;">√ó</button>` : 
                                '<div style="width:36px;"></div>'}
                        </div>
                    `;
                });
                document.getElementById('btnStart').disabled = this.session.players.length < 2;
            }

            startGame() {
                this.flow = new FlowController(this.lang);
                this.pot = null;
                this.session.players.forEach(p => {
                    p.clothes = 5; 
                    p.out = false;
                    p.betMade = false;
                    p.bonusItems = 0;
                });
                this.session.current = 0;
                this.session.round = 0;
                this.session.potActive = false;
                
                document.querySelectorAll('.overlay').forEach(o => o.classList.remove('active'));
                document.getElementById('overlay-game').classList.add('active');
                document.getElementById('playerQueue').classList.remove('hidden');
                document.getElementById('fabContainer').classList.add('active');
                
                this.updateGameUI();
            }

            updateGameUI() {
                let guard = 0;
                while (this.session.players[this.session.current]?.out && guard++ < 20) {
                    this.session.current = (this.session.current + 1) % this.session.players.length;
                }
                
                const alive = this.session.players.filter(p => !p.out);
                if (alive.length === 1) {
                    this.endGame(alive[0]);
                    return;
                }

                const q = document.getElementById('playerQueue');
                q.innerHTML = '';
                this.session.players.forEach((p, i) => {
                    if (!p.out) {
                        const active = i === this.session.current;
                        const hasPot = this.pot && this.pot.owner === i;
                        const chip = document.createElement('div');
                        chip.className = `player-chip ${active ? 'active' : ''} ${hasPot ? 'pot-owner' : ''}`;
                        chip.textContent = `${p.name} ${p.clothes > 0 ? '(' + p.clothes + ')' : ''} ${hasPot ? 'üëë' : ''}`;
                        q.appendChild(chip);
                    }
                });

                document.getElementById('view-dice').style.display = 'flex';
                document.querySelectorAll('.game-card').forEach(c => c.classList.remove('active'));
                document.getElementById('gameControls').style.display = 'flex';
                document.getElementById('btnNext').style.display = 'none';
                document.getElementById('btnHighStakes').style.display = 'none';
            }

            roll() {
                this.session.round++;
                document.getElementById('view-dice').style.display = 'none';
                
                const cat = this.flow.selectNextCategory();
                
                if (cat === 'chaos') {
                    this.showChaos();
                } else {
                    this.showCategory(cat);
                }
            }

            showChaos() {
                const events = I18N[this.lang].chaos;
                const c = events[Math.floor(Math.random() * events.length)];
                this.session.chaos = c;
                
                document.getElementById('card-chaos').classList.add('active');
                document.getElementById('text-chaos').innerText = c.t;
                document.getElementById('sub-chaos').innerText = c.d;
                
                if (c.e === 'swap') {
                    const next = (this.session.current + 1) % this.session.players.length;
                    if (!this.session.players[this.session.current].out && !this.session.players[next].out) {
                        const t = this.session.players[this.session.current].name;
                        this.session.players[this.session.current].name = this.session.players[next].name;
                        this.session.players[next].name = t;
                    }
                }
                
                this.flow.addToHistory('chaos', c.n);
                
                document.getElementById('gameControls').style.display = 'none';
                document.getElementById('btnNext').style.display = 'block';
            }

            showCategory(cat) {
                const deck = I18N[this.lang].decks;
                const task = this.flow.getUniqueTask(cat, deck);
                
                document.getElementById('card-' + cat).classList.add('active');
                
                if (cat === 'action') {
                    document.getElementById('text-action').innerText = task.t;
                    document.getElementById('sub-action').innerText = 'üî•'.repeat(task.i);
                } else if (cat === 'quiz') {
                    document.getElementById('text-quiz').innerText = task.q;
                    const opts = document.getElementById('quiz-options');
                    opts.innerHTML = '';
                    task.a.forEach((a, i) => {
                        opts.innerHTML += `<button class="btn" style="margin-bottom:8px; text-transform: none;" 
                            onclick="game.answerQuiz(${i === task.c})">${a}</button>`;
                    });
                } else if (cat === 'tabu') {
                    document.getElementById('text-tabu').innerText = task.w;
                    document.getElementById('list-tabu').innerHTML = task.f.map(x => 
                        `<div class="tabu-word">${x}</div>`).join('');
                } else if (cat === 'z') {
                    document.getElementById('text-z').innerText = task;
                }
                
                if (cat === 'quiz') {
                    document.getElementById('gameControls').style.display = 'none';
                }
                
                this.flow.addToHistory(cat, task);
            }

            answerQuiz(correct) {
                if (correct) {
                    this.success();
                } else {
                    this.fail();
                }
            }

            success() {
                this.next();
            }

            fail() {
                let loss = 1;
                if (this.session.chaos?.e === 'double') loss = 2;
                if (this.session.chaos?.e === 'bjforced') loss = 3;
                
                const p = this.session.players[this.session.current];
                const newClothes = p.clothes - loss;
                
                if (newClothes <= 0 && !p.out) {
                    if (newClothes === 0 && !p.betMade && !this.session.potActive) {
                        p.clothes = 0;
                        this.offerBet();
                        return;
                    } else if (this.session.potActive && this.pot && this.pot.owner !== p.id) {
                        p.clothes = 0;
                        this.checkChallenge();
                        return;
                    } else {
                        p.out = true;
                        p.clothes = 0;
                        
                        if (this.pot && this.pot.owner === p.id) {
                            this.resolvePot(true);
                        }
                    }
                } else {
                    p.clothes = newClothes;
                }
                
                this.next();
            }

            offerBet() {
                document.getElementById('modal-bet').classList.add('active');
                document.getElementById('videoUrl').value = '';
                this.setBetRounds(1);
            }

            setBetRounds(rounds) {
                this.betRounds = rounds;
                document.getElementById('btnRounds1').style.opacity = rounds === 1 ? '1' : '0.5';
                document.getElementById('btnRounds3').style.opacity = rounds === 3 ? '1' : '0.5';
                
                const time = 10;
                const totalTime = time * rounds;
                const t = I18N[this.lang];
                
                document.getElementById('betSummary').innerHTML = `
                    1 Item √ó 10s √ó ${rounds} ${t.round}${rounds > 1 ? 's' : ''}<br>
                    <strong>Total: ${totalTime}s</strong><br>
                    <small style="color: var(--text-secondary)">${rounds === 3 ? 'Loss: 3x penalty' : 'Loss: Immediate'}</small>
                `;
            }

            confirmBet() {
                const url = document.getElementById('videoUrl').value.trim();
                if (!url) {
                    alert(I18N[this.lang].betPrompt);
                    return;
                }
                
                const p = this.session.players[this.session.current];
                
                this.pot = {
                    owner: p.id,
                    videoUrl: url,
                    baseTime: 10,
                    rounds: this.betRounds,
                    items: 1,
                    claimed: false,
                    overbidTime: 0,
                    challenger: null,
                    currentRound: 1
                };
                
                p.betMade = true;
                p.clothes = 0;
                p.out = false;
                
                this.session.potActive = true;
                document.getElementById('modal-bet').classList.remove('active');
                document.getElementById('potIndicator').classList.add('active');
                document.getElementById('potText').innerText = `POT: ${this.pot.baseTime}s`;
                
                this.next();
            }

            fold() {
                const p = this.session.players[this.session.current];
                p.out = true;
                document.getElementById('modal-bet').classList.remove('active');
                this.next();
            }

            checkChallenge() {
                const currentP = this.session.players[this.session.current];
                
                if (this.pot && this.pot.owner !== currentP.id && !currentP.betMade) {
                    document.getElementById('modal-challenge').classList.add('active');
                    const owner = this.session.players[this.pot.owner];
                    const t = I18N[this.lang];
                    document.getElementById('challengeInfo').innerHTML = 
                        `<strong>${owner.name}</strong> ${t.challengeInfo}`;
                    document.getElementById('currentPotDetails').innerHTML = 
                        `${this.pot.baseTime}s Video<br>1 Item = 10s`;
                } else {
                    currentP.out = true;
                    this.next();
                }
            }

            acceptChallenge(rounds) {
                const p = this.session.players[this.session.current];
                this.pot.challenger = p.id;
                this.pot.challengeRounds = rounds;
                
                document.getElementById('modal-challenge').classList.remove('active');
                this.startBjChallenge();
            }

            declineChallenge() {
                const p = this.session.players[this.session.current];
                p.out = true;
                document.getElementById('modal-challenge').classList.remove('active');
                this.next();
            }

            startBjChallenge() {
                const owner = this.session.players[this.pot.owner];
                const challenger = this.session.players[this.pot.challenger];
                
                this.bj = {
                    challenger: this.pot.challenger,
                    owner: this.pot.owner,
                    deck: this.createDeck(),
                    ph: [],
                    oh: [],
                    round: 1,
                    maxRounds: this.pot.challengeRounds || 1
                };
                
                this.bj.ph.push(this.bj.deck.pop(), this.bj.deck.pop());
                this.bj.oh.push(this.bj.deck.pop(), this.bj.deck.pop());
                
                document.getElementById('bjOppName').innerText = owner.name;
                document.getElementById('modal-bj-challenge').classList.add('active');
                document.getElementById('bjRoundInfo').innerText = `${I18N[this.lang].round} ${this.bj.round}/${this.bj.maxRounds}`;
                
                this.updateBjUI();
            }

            updateBjUI() {
                const render = (hand, hide = false) => {
                    return hand.map((c, i) => {
                        if (hide && i === 1) return '<div class="bj-card hidden"></div>';
                        const isRed = c.s === '‚ô•' || c.s === '‚ô¶';
                        return `<div class="bj-card ${isRed ? 'red' : ''}">${c.l}${c.s}</div>`;
                    }).join('');
                };

                document.getElementById('bjPlayerHand').innerHTML = render(this.bj.ph);
                document.getElementById('bjPlayerScore').innerText = this.calcHand(this.bj.ph);
                document.getElementById('bjOppHand').innerHTML = render(this.bj.oh, true);
                document.getElementById('bjOppScore').innerText = '?';
            }

            bjHit() {
                this.bj.ph.push(this.bj.deck.pop());
                this.updateBjUI();
                if (this.calcHand(this.bj.ph) >= 21) {
                    setTimeout(() => this.bjStand(), 500);
                }
            }

            bjStand() {
                let oppScore = this.calcHand(this.bj.oh);
                while (oppScore < 17) {
                    this.bj.oh.push(this.bj.deck.pop());
                    oppScore = this.calcHand(this.bj.oh);
                }
                
                document.getElementById('bjOppHand').innerHTML = this.bj.oh.map(c => {
                    const isRed = c.s === '‚ô•' || c.s === '‚ô¶';
                    return `<div class="bj-card ${isRed ? 'red' : ''}">${c.l}${c.s}</div>`;
                }).join('');
                document.getElementById('bjOppScore').innerText = oppScore;
                
                setTimeout(() => this.resolveBjRound(), 1000);
            }

            resolveBjRound() {
                const pScore = this.calcHand(this.bj.ph);
                const oScore = this.calcHand(this.bj.oh);
                const challenger = this.session.players[this.bj.challenger];
                const owner = this.session.players[this.bj.owner];
                
                let challengerWon = false;
                
                if (pScore > 21) challengerWon = false;
                else if (oScore > 21) challengerWon = true;
                else if (pScore > oScore) challengerWon = true;
                else if (pScore < oScore) challengerWon = false;
                else challengerWon = false;
                
                if (challengerWon) {
                    challenger.clothes += this.pot.items;
                    challenger.bonusItems += Math.floor(this.pot.overbidTime / 5);
                    
                    if (this.bj.round >= this.bj.maxRounds) {
                        this.pot.owner = challenger.id;
                        this.showToast(`${challenger.name} ${I18N[this.lang].winner}!`);
                        this.endBjChallenge();
                    } else {
                        this.bj.round++;
                        this.bj.ph = [];
                        this.bj.oh = [];
                        this.bj.ph.push(this.bj.deck.pop(), this.bj.deck.pop());
                        this.bj.oh.push(this.bj.deck.pop(), this.bj.deck.pop());
                        document.getElementById('bjRoundInfo').innerText = `${I18N[this.lang].round} ${this.bj.round}/${this.bj.maxRounds}`;
                        this.updateBjUI();
                    }
                } else {
                    const multiplier = this.pot.challengeRounds === 3 ? 3 : 1;
                    const penalty = this.pot.baseTime * multiplier;
                    
                    challenger.out = true;
                    this.showToast(`${challenger.name} - ${penalty}s Video`);
                    this.endBjChallenge();
                }
            }

            endBjChallenge() {
                document.getElementById('modal-bj-challenge').classList.remove('active');
                this.bj = null;
                
                const alive = this.session.players.filter(p => !p.out);
                if (alive.length === 1 && this.pot && alive[0].id === this.pot.owner) {
                    this.resolvePot();
                }
                
                this.next();
            }

            resolvePot(ownerLost = false) {
                if (this.pot) {
                    const owner = this.session.players[this.pot.owner];
                    if (!owner.out && !ownerLost) {
                        owner.clothes = this.pot.items + owner.bonusItems;
                        this.showToast(`${owner.name}: ${owner.clothes} Items back!`);
                    } else {
                        this.showToast("Pot expired");
                    }
                    this.pot = null;
                    this.session.potActive = false;
                    document.getElementById('potIndicator').classList.remove('active');
                }
            }

            showToast(msg) {
                const toast = document.createElement('div');
                toast.className = 'toast';
                toast.textContent = msg;
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 3000);
            }

            adjustOverbid(amount) {
                this.overbidAmount = Math.max(0, this.overbidAmount + amount);
                document.getElementById('overbidTime').innerText = `+${this.overbidAmount}s`;
                document.getElementById('overbidBonus').innerText = `+${Math.floor(this.overbidAmount / 5)} Items`;
            }

            confirmOverbid() {
                if (this.pot && this.overbidAmount > 0) {
                    this.pot.overbidTime = this.overbidAmount;
                    this.pot.baseTime += this.overbidAmount;
                    this.showToast(`+${this.overbidAmount}s`);
                }
                document.getElementById('modal-overbid').classList.remove('active');
                this.overbidAmount = 0;
            }

            closeOverbid() {
                document.getElementById('modal-overbid').classList.remove('active');
                this.overbidAmount = 0;
            }

            next() {
                this.session.chaos = null;
                let nextIndex = this.session.current;
                let attempts = 0;
                
                do {
                    nextIndex = (nextIndex + 1) % this.session.players.length;
                    attempts++;
                } while (this.session.players[nextIndex].out && attempts < this.session.players.length);
                
                this.session.current = nextIndex;
                this.updateGameUI();
            }

            startBlackjackChallenge() {
                // Diese Methode wird vom "High Stakes" Button im Spiel aufgerufen
                const alive = this.session.players.filter(p => !p.out && p.id !== this.session.current);
                if (alive.length === 0) return;
                
                const opp = alive[Math.floor(Math.random() * alive.length)];
                
                this.bj = {
                    challenger: this.session.current,
                    owner: opp.id,
                    deck: this.createDeck(),
                    ph: [],
                    oh: [],
                    round: 1,
                    maxRounds: 1,
                    casual: true
                };
                
                this.bj.ph.push(this.bj.deck.pop(), this.bj.deck.pop());
                this.bj.oh.push(this.bj.deck.pop(), this.bj.deck.pop());
                
                document.getElementById('bjOppName').innerText = opp.name;
                document.getElementById('bjRoundInfo').innerText = 'CASUAL';
                document.getElementById('modal-bj-challenge').classList.add('active');
                this.updateBjUI();
            }

            endGame(winner) {
                document.querySelectorAll('.overlay').forEach(o => o.classList.remove('active'));
                document.getElementById('overlay-result').classList.add('active');
                document.getElementById('winnerName').innerText = winner.name;
                document.getElementById('playerQueue').classList.add('hidden');
                document.getElementById('fabContainer').classList.remove('active');
            }

            reset() {
                this.showStart();
            }
            
            showRules() {
                alert(I18N[this.lang].rulesText);
            }
        }

        const game = new Game();
    </script>
</body>
</html>
