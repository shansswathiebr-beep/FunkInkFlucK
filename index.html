<!DOCTYPE html>
<html lang="de" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="FUNKENFLUG v8.1 - Das ultimative High-Stakes Partyspiel mit 4-Ring-Rad, AI-Bots und 22 Sprachen">
    <title>FUNKENFLUG v8.1 - Ultimate Party Experience</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;600;800&family=Noto+Sans:wght@300;400;600;700&family=Noto+Sans+Arabic:wght@400;700&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --gold-primary: #D4AF37;
            --gold-light: #F4E4BA;
            --gold-dark: #AA8C2C;
            --black-primary: #0A0A0A;
            --black-secondary: #1A1A1A;
            --black-tertiary: #2A2A2A;
            --accent-red: #FF4136;
            --accent-green: #2ECC40;
            --accent-blue: #0074D9;
            --video: #ff0066;
            --text-primary: #F5F5F5;
            --text-secondary: #B0B0B0;
            --text-muted: #707070;
            --bg-glass: rgba(20, 20, 20, 0.95);
            --border: rgba(212, 175, 55, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Inter', 'Noto Sans', sans-serif;
            user-select: none;
        }

        html[dir="rtl"] * { text-align: right; }
        html[dir="rtl"] .rules-container, html[dir="rtl"] .rules-text { text-align: right; }

        body {
            background: var(--black-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow: hidden;
            position: fixed;
            width: 100%;
            font-family: 'Inter', sans-serif;
        }

        /* Background Pattern */
        .bg-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(212, 175, 55, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.03) 0%, transparent 50%),
                linear-gradient(to bottom, transparent 95%, rgba(212, 175, 55, 0.05) 100%);
            pointer-events: none;
            z-index: -1;
        }

        /* Watermark */
        .watermark {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 9px;
            color: rgba(212, 175, 55, 0.3);
            text-align: right;
            line-height: 1.3;
            pointer-events: none;
            z-index: 9999;
        }
        html[dir="rtl"] .watermark { right: auto; left: 10px; text-align: left; }
        .watermark strong { display: block; color: rgba(212, 175, 55, 0.5); font-weight: 500; }

        /* Premium Badge */
        .premium-badge {
            position: fixed;
            top: 60px;
            right: 15px;
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-light));
            color: #000;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 11px;
            z-index: 101;
            display: none;
            align-items: center;
            gap: 6px;
            box-shadow: 0 2px 10px rgba(255, 215, 0, 0.3);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0%, 100% { box-shadow: 0 2px 10px rgba(255, 215, 0, 0.3); }
            50% { box-shadow: 0 2px 20px rgba(255, 215, 0, 0.6); }
        }
        .premium-badge.active { display: flex; }

        /* Round Counter */
        .round-counter {
            position: fixed;
            top: 60px;
            left: 15px;
            background: rgba(212, 175, 55, 0.15);
            border: 1px solid var(--border);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            z-index: 101;
            color: var(--gold-primary);
            display: none;
        }
        .round-counter.active { display: block; }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding-top: env(safe-area-inset-top, 10px);
            z-index: 100;
            background: linear-gradient(to bottom, rgba(10,10,10,0.95), rgba(10,10,10,0.8));
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--gold-dark);
        }

        .header-left { 
            position: absolute; 
            left: 15px; 
            top: 50%; 
            transform: translateY(-50%); 
            display: flex;
            gap: 10px;
        }
        html[dir="rtl"] .header-left { left: auto; right: 15px; }

        .lang-btn {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid var(--border);
            color: var(--gold-primary);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .lang-btn:hover { background: var(--gold-primary); color: #000; }

        .header-controls {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 10px;
        }
        html[dir="rtl"] .header-controls { right: auto; left: 15px; }

        .btn-icon {
            background: rgba(212, 175, 55, 0.1);
            border: 1px solid var(--border);
            color: var(--gold-primary);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 1rem;
        }
        .btn-icon:hover {
            background: var(--gold-primary);
            color: var(--black-primary);
            transform: scale(1.1);
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 80px 20px 40px;
            height: 100vh;
            overflow-y: auto;
        }

        /* Screen Management */
        .screen {
            display: none;
            animation: fadeIn 0.5s ease;
            height: 100%;
        }
        .screen.active { display: block; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Typography */
        h1, h2, h3 {
            font-family: 'Cinzel', serif;
            color: var(--gold-primary);
            margin-bottom: 1rem;
        }
        h1 { font-size: 2.5rem; text-align: center; }
        h2 { font-size: 2rem; }
        h3 { font-size: 1.5rem; }

        .subtitle {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        /* Buttons */
        .btn {
            width: 100%;
            padding: 16px;
            border-radius: 16px;
            border: none;
            background: rgba(255,255,255,0.05);
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 1px solid transparent;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        .btn:hover { transform: translateY(-2px); }
        .btn:active { transform: scale(0.96); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; }
        
        .btn-gold { 
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-dark)); 
            color: #000; 
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.3);
        }
        .btn-gold:hover { box-shadow: 0 6px 25px rgba(212, 175, 55, 0.5); }
        
        .btn-secondary {
            background: transparent;
            border: 2px solid var(--gold-primary);
            color: var(--gold-primary);
        }
        .btn-secondary:hover { background: var(--gold-primary); color: #000; }
        
        .btn-danger { background: rgba(255, 51, 51, 0.1); color: var(--accent-red); border: 1px solid rgba(255, 51, 51, 0.3); }
        .btn-success { background: rgba(0, 200, 83, 0.1); color: var(--accent-green); border: 1px solid rgba(0, 200, 83, 0.3); }
        .btn-ai { background: rgba(41, 121, 255, 0.15); color: var(--accent-blue); border: 1px solid rgba(41, 121, 255, 0.3); }
        .btn-video { background: rgba(255, 0, 102, 0.15); color: var(--video); border: 1px solid rgba(255, 0, 102, 0.3); }

        .btn-large { padding: 1.5rem 3rem; font-size: 1.2rem; }
        .btn-group { display: flex; gap: 12px; margin-top: 20px; flex-wrap: wrap; }
        .btn-group .btn { flex: 1; min-width: 120px; }

        /* Glass Card */
        .glass-card {
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 32px;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            backdrop-filter: blur(20px);
            max-height: 90vh;
            overflow-y: auto;
        }

        /* 4-Ring Wheel System */
        .wheel-container {
            position: relative;
            width: 500px;
            height: 500px;
            margin: 2rem auto;
            perspective: 1000px;
        }

        .wheel-ring {
            position: absolute;
            border-radius: 50%;
            border: 3px solid var(--gold-dark);
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.2), inset 0 0 30px rgba(0,0,0,0.5);
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .wheel-ring-outer {
            width: 500px;
            height: 500px;
            background: conic-gradient(
                from 0deg,
                #2A1810 0deg 60deg,
                #1A1A1A 60deg 120deg,
                #2A1810 120deg 180deg,
                #1A1A1A 180deg 240deg,
                #2A1810 240deg 300deg,
                #1A1A1A 300deg 360deg
            );
        }

        .wheel-ring-mid {
            width: 380px;
            height: 380px;
            top: 60px;
            left: 60px;
            background: conic-gradient(
                from 0deg,
                #1A1A1A 0deg 90deg,
                #0F0F0F 90deg 180deg,
                #1A1A1A 180deg 270deg,
                #0F0F0F 270deg 360deg
            );
        }

        .wheel-ring-inner {
            width: 260px;
            height: 260px;
            top: 120px;
            left: 120px;
            background: conic-gradient(
                from 0deg,
                #0F0F0F 0deg 120deg,
                #1A1A1A 120deg 240deg,
                #0F0F0F 240deg 360deg
            );
        }

        .wheel-ring-core {
            width: 140px;
            height: 140px;
            top: 180px;
            left: 180px;
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-dark));
            font-family: 'Cinzel', serif;
            font-weight: 900;
            font-size: 1.5rem;
            color: var(--black-primary);
            box-shadow: 0 0 40px rgba(212, 175, 55, 0.6);
        }

        .wheel-pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 30px solid var(--gold-primary);
            filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.8));
            z-index: 10;
        }

        .spin-btn {
            display: block;
            margin: 2rem auto;
            padding: 1.5rem 4rem;
            font-size: 1.5rem;
        }

        /* Game Mode Selection */
        .mode-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .mode-card {
            background: linear-gradient(145deg, var(--black-secondary), var(--black-tertiary));
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .mode-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
            transition: left 0.5s ease;
        }
        .mode-card:hover::before { left: 100%; }
        .mode-card:hover {
            border-color: var(--gold-primary);
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.2);
        }
        .mode-card.selected {
            border-color: var(--gold-primary);
            background: rgba(212, 175, 55, 0.1);
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.3);
        }

        .mode-icon { font-size: 3rem; color: var(--gold-primary); margin-bottom: 1rem; }
        .mode-title { font-family: 'Cinzel', serif; font-size: 1.3rem; color: var(--gold-primary); margin-bottom: 0.5rem; }
        .mode-desc { color: var(--text-secondary); font-size: 0.9rem; }
        .mode-premium {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--gold-primary);
            color: var(--black-primary);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 700;
        }

        /* Player Setup */
        .player-input-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            align-items: center;
        }
        .input-field {
            flex: 1;
            background: var(--black-tertiary);
            border: 1px solid rgba(212, 175, 55, 0.3);
            color: var(--text-primary);
            padding: 0.8rem 1rem;
            border-radius: 8px;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }
        .input-field:focus {
            border-color: var(--gold-primary);
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }

        .player-list { margin: 2rem 0; }
        .player-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(212, 175, 55, 0.05);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }
        .player-name { font-weight: 600; color: var(--gold-primary); }
        .player-type {
            font-size: 0.8rem;
            color: var(--text-muted);
            background: var(--black-tertiary);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            margin-left: 10px;
        }
        html[dir="rtl"] .player-type { margin-left: 0; margin-right: 10px; }

        /* Bot Selection */
        .bot-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        .bot-card {
            background: linear-gradient(145deg, var(--black-secondary), var(--black-tertiary));
            border: 2px solid rgba(212, 175, 55, 0.2);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .bot-card:hover {
            border-color: var(--gold-primary);
            transform: scale(1.05);
        }
        .bot-card.selected {
            border-color: var(--gold-primary);
            background: rgba(212, 175, 55, 0.1);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
        }
        .bot-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-dark));
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: var(--black-primary);
        }
        .bot-name { font-family: 'Cinzel', serif; color: var(--gold-primary); margin-bottom: 0.5rem; }
        .bot-trait { font-size: 0.8rem; color: var(--text-secondary); font-style: italic; }

        /* Language Selection */
        .lang-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
            max-height: 60vh;
            overflow-y: auto;
        }
        .lang-btn-large {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 1rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 0.9rem;
        }
        .lang-btn-large:hover { border-color: var(--gold-primary); background: rgba(212, 175, 55, 0.1); }
        .lang-btn-large.active {
            background: var(--gold-primary);
            color: var(--black-primary);
            border-color: var(--gold-primary);
            font-weight: 700;
        }
        .lang-code { font-size: 1.5rem; font-weight: 700; display: block; margin-bottom: 0.3rem; }

        /* Game Card Display */
        .game-card {
            background: linear-gradient(145deg, rgba(20,20,20,0.95) 0%, rgba(10,10,10,0.98) 100%);
            border: 2px solid var(--gold-primary);
            border-radius: 32px;
            padding: 40px 30px;
            text-align: center;
            max-width: 600px;
            margin: 2rem auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            display: none;
        }
        .game-card.active { display: block; animation: cardEnter 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); }
        @keyframes cardEnter {
            from { opacity: 0; transform: scale(0.9) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .card-glow {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--gold-primary), transparent);
        }
        .card-type-badge {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--gold-primary);
            color: var(--black-primary);
            padding: 0.5rem 2rem;
            border-radius: 20px;
            font-weight: 700;
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
        }
        .card-content {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            line-height: 1.6;
            color: var(--text-primary);
            margin: 2rem 0;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .card-category {
            color: var(--gold-primary);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-top: 1rem;
        }

        /* Tabu Cards */
        .tabu-forbidden {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-top: 20px;
        }
        .tabu-word {
            background: rgba(255, 51, 51, 0.1);
            color: var(--accent-red);
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 13px;
            border: 1px solid rgba(255, 51, 51, 0.3);
        }

        /* Quiz Options */
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }
        .quiz-options button.correct { background: rgba(0, 200, 83, 0.2) !important; border-color: var(--accent-green) !important; color: var(--accent-green) !important; }
        .quiz-options button.wrong { background: rgba(255, 51, 51, 0.2) !important; border-color: var(--accent-red) !important; color: var(--accent-red) !important; }

        /* Timer for Quiz */
        .timer-bar {
            width: 100%;
            height: 6px;
            background: var(--black-tertiary);
            border-radius: 3px;
            margin: 1rem 0;
            overflow: hidden;
        }
        .timer-progress {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-red));
            width: 100%;
            transition: width 0.1s linear;
        }

        /* Blackjack Styles */
        .blackjack-table {
            background: linear-gradient(to bottom, #0d5c3b, #083d27);
            border-radius: 16px;
            padding: 2rem;
            border: 4px solid var(--gold-dark);
            margin: 2rem 0;
        }
        .hand {
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
        }
        .hand-label { color: var(--gold-primary); font-weight: 700; margin-bottom: 0.5rem; }
        .cards { display: flex; gap: 0.5rem; flex-wrap: wrap; justify-content: center; }
        .playing-card {
            width: 60px;
            height: 90px;
            background: white;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            color: var(--black-primary);
        }
        .playing-card.red { color: var(--accent-red); }

        /* Modals */
        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.95);
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
            z-index: 1000;
        }
        .modal.active { display: flex; }
        
        .modal-content {
            background: var(--bg-glass);
            border: 2px solid var(--gold-primary);
            border-radius: 24px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-header {
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), transparent);
            padding: 1.5rem;
            border-bottom: 1px solid rgba(212, 175, 55, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-body { padding: 2rem; }

        .close-modal {
            background: none;
            border: none;
            color: var(--gold-primary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.3s ease;
            position: absolute;
            top: 15px;
            right: 15px;
            z-index: 10;
        }
        .close-modal:hover { transform: rotate(90deg); }

        /* Bet Interface */
        .bet-interface {
            background: var(--bg-glass);
            border: 1px solid var(--gold-primary);
            border-radius: 24px;
            padding: 24px;
            width: 100%;
            max-width: 400px;
        }
        .bet-interface.video { border-color: var(--video); }
        .bet-title { font-size: 20px; color: var(--gold-primary); text-align: center; margin-bottom: 20px; text-transform: uppercase; }
        .bet-title.video { color: var(--video); }
        .bet-info { font-size: 12px; color: var(--text-secondary); text-align: center; margin-bottom: 20px; line-height: 1.6; }

        .video-input-group {
            margin: 16px 0; padding: 16px;
            background: rgba(255, 0, 102, 0.05);
            border: 1px solid rgba(255, 0, 102, 0.2);
            border-radius: 12px;
        }
        .video-label { font-size: 12px; color: var(--video); margin-bottom: 8px; display: block; font-weight: 600; }
        .video-input {
            width: 100%; padding: 12px; border-radius: 8px;
            border: 1px solid rgba(255, 0, 102, 0.3);
            background: rgba(0,0,0,0.3);
            color: var(--text-primary); font-size: 14px; outline: none;
        }
        .video-input:focus { border-color: var(--video); box-shadow: 0 0 10px rgba(255, 0, 102, 0.2); }
        .video-hint { font-size: 11px; color: var(--text-secondary); margin-top: 6px; font-style: italic; }
        .video-preview {
            margin-top: 12px; padding: 10px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            font-size: 12px; color: var(--video);
            word-break: break-all; display: none;
        }
        .video-preview.active { display: block; }

        /* Pot Indicator */
        .pot-indicator {
            background: rgba(212, 175, 55, 0.15);
            border: 1px solid var(--border);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            color: var(--gold-primary);
            display: none;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: all 0.2s;
            animation: pulse 2s infinite;
        }
        .pot-indicator.active { display: flex; }
        .pot-indicator.video-active { border-color: var(--video); color: var(--video); background: rgba(255, 0, 102, 0.1); }
        @keyframes pulse {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; box-shadow: 0 0 20px rgba(212, 175, 55, 0.3); }
        }

        /* Player Queue */
        .player-queue {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 50;
            max-width: 90%;
            overflow-x: auto;
            scrollbar-width: none;
            padding: 10px;
        }
        .player-queue::-webkit-scrollbar { display: none; }
        .player-queue.hidden { display: none; }
        .player-chip {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            color: var(--text-secondary);
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .player-chip.active { background: var(--gold-primary); color: #000; border-color: var(--gold-primary); transform: scale(1.1); font-weight: 600; }
        .player-chip.out { opacity: 0.2; text-decoration: line-through; }
        .player-chip.bot { border-color: rgba(41, 121, 255, 0.3); background: rgba(41, 121, 255, 0.1); }
        .player-chip.bot.active { background: var(--accent-blue); color: white; }

        /* Bot Moderator Bubble */
        .bot-moderator {
            position: fixed;
            top: 60px;
            left: 50%;
            transform: translateX(-50%) translateY(-20px);
            width: 85%;
            max-width: 380px;
            background: rgba(20, 20, 20, 0.95);
            border: 1px solid var(--gold-primary);
            border-radius: 16px;
            padding: 12px 16px;
            z-index: 200;
            display: none;
            opacity: 0;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }
        .bot-moderator.active {
            display: flex;
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        .bot-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: 2px solid var(--gold-primary);
            margin-right: 12px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            background: rgba(212, 175, 55, 0.1);
        }
        html[dir="rtl"] .bot-avatar { margin-right: 0; margin-left: 12px; }
        .bot-name { 
            font-size: 11px; 
            color: var(--gold-primary); 
            text-transform: uppercase; 
            letter-spacing: 1px; 
            font-weight: 700;
        }
        .bot-text { 
            font-size: 13px; 
            font-style: italic; 
            line-height: 1.4; 
            color: var(--text-primary);
        }

        /* Toast */
        .toast {
            position: fixed;
            top: 120px;
            left: 50%;
            transform: translateX(-50%) translateY(-20px);
            background: var(--bg-glass);
            border: 1px solid var(--gold-primary);
            color: var(--gold-primary);
            padding: 16px 32px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            z-index: 3000;
            opacity: 0;
            transition: all 0.3s ease;
            pointer-events: none;
            text-align: center;
        }
        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        .toast.success { border-color: var(--accent-green); color: var(--accent-green); }
        .toast.error { border-color: var(--accent-red); color: var(--accent-red); }
        .toast.video { border-color: var(--video); color: var(--video); }
        .toast.premium { border-color: var(--gold-primary); color: #000; background: linear-gradient(135deg, rgba(255,215,0,0.9), rgba(255,237,78,0.9)); }

        /* Support FAB */
        .support-fab {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--gold-primary), var(--gold-dark));
            color: #000;
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            cursor: pointer;
            font-weight: bold;
            font-size: 13px;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.4);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        .support-fab:hover { transform: translateY(-2px) scale(1.05); }
        html[dir="rtl"] .support-fab { right: auto; left: 20px; }

        /* Premium Features Grid */
        .features-grid {
            display: grid;
            gap: 12px;
            margin: 20px 0;
        }
        .feature-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.3s;
        }
        .feature-card:hover { background: rgba(255, 255, 255, 0.08); transform: translateX(5px); }
        .feature-card.locked { opacity: 0.5; position: relative; }
        .feature-card.locked::after {
            content: 'üîí';
            position: absolute;
            right: 15px;
            font-size: 18px;
        }
        .feature-card.unlocked {
            border-color: var(--gold-primary);
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(212, 175, 55, 0.05));
        }
        .feature-icon {
            font-size: 24px;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        .feature-info h3 { color: white; font-size: 15px; margin-bottom: 4px; }
        .feature-info p { color: var(--text-secondary); font-size: 13px; }

        /* Deck Selector */
        .deck-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .deck-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
            position: relative;
        }
        .deck-btn:hover { background: rgba(212, 175, 55, 0.1); border-color: var(--gold-primary); }
        .deck-btn.active { background: var(--gold-primary); color: #000; border-color: var(--gold-primary); }
        .deck-btn.premium-deck { border-color: var(--gold-primary); color: var(--gold-primary); }
        .deck-btn.premium-deck::after { content: 'üëë'; margin-left: 5px; font-size: 11px; }
        .deck-btn.locked { opacity: 0.5; cursor: not-allowed; }

        /* Responsive */
        @media (max-width: 768px) {
            .wheel-container { width: 350px; height: 350px; }
            .wheel-ring-outer { width: 350px; height: 350px; }
            .wheel-ring-mid { width: 270px; height: 270px; top: 40px; left: 40px; }
            .wheel-ring-inner { width: 190px; height: 190px; top: 80px; left: 80px; }
            .wheel-ring-core { width: 110px; height: 110px; top: 120px; left: 120px; font-size: 1rem; }
            h1 { font-size: 1.8rem; }
            .mode-grid { grid-template-columns: 1fr; }
            .glass-card { padding: 24px 20px; margin: 10px; }
            .support-fab { padding: 10px 16px; font-size: 12px; }
        }

        @media (max-width: 380px) {
            h1 { font-size: 1.5rem; }
            .wheel-container { transform: scale(0.8); }
        }

        /* Utility */
        .text-center { text-align: center; }
        .mt-2 { margin-top: 2rem; }
        .mb-2 { margin-bottom: 2rem; }
        .hidden { display: none !important; }

        /* Animations */
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(212, 175, 55, 0.5); }
            50% { box-shadow: 0 0 20px rgba(212, 175, 55, 0.8); }
        }
        .glow { animation: glow 2s infinite; }

        /* Main Title */
        .main-title { 
            font-size: 52px; 
            font-weight: 100; 
            letter-spacing: 16px; 
            color: var(--gold-primary); 
            margin-bottom: 10px; 
            text-transform: uppercase; 
            text-align: center; 
            font-family: 'Cinzel', serif;
        }
        @media (max-width: 768px) {
            .main-title { font-size: 36px; letter-spacing: 8px; }
        }

        .feature-tags { 
            display: flex; 
            gap: 10px; 
            justify-content: center; 
            margin-bottom: 40px; 
            flex-wrap: wrap; 
        }
        .tag { 
            background: rgba(212, 175, 55, 0.1); 
            border: 1px solid var(--border); 
            padding: 8px 16px; 
            border-radius: 20px; 
            font-size: 11px; 
            color: var(--gold-primary); 
        }
        .tag.ai { background: rgba(41, 121, 255, 0.1); border-color: rgba(41, 121, 255, 0.3); color: var(--accent-blue); }
        .tag.premium { background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,237,78,0.1)); border-color: var(--gold-primary); color: var(--gold-primary); font-weight: bold; }

        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 20px 0;
        }
        .step-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            cursor: pointer;
        }
        .step-dot.active { background: var(--gold-primary); }

        .lobby-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .rules-container, .rules-text {
            text-align: left;
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-secondary);
            max-height: 60vh;
            overflow-y: auto;
        }
        .rules-section { margin-bottom: 24px; padding-bottom: 20px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .rules-section:last-child { border-bottom: none; }
        .rules-title { color: var(--gold-primary); font-size: 16px; font-weight: 700; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .rules-icon { font-size: 20px; }
        .rules-list { list-style: none; padding: 0; margin: 0; }
        .rules-list li { margin-bottom: 8px; padding-left: 20px; position: relative; }
        html[dir="rtl"] .rules-list li { padding-left: 0; padding-right: 20px; }
        .rules-list li:before { content: "‚ñ∏"; color: var(--gold-primary); position: absolute; left: 0; }
        html[dir="rtl"] .rules-list li:before { left: auto; right: 0; }

        .highlight { color: var(--gold-primary); font-weight: 600; }
        .danger-highlight { color: var(--accent-red); font-weight: 600; }
        .success-highlight { color: var(--accent-green); font-weight: 600; }
        .video-highlight { color: var(--video); font-weight: 600; }

        .example-box {
            background: rgba(212, 175, 55, 0.1);
            border-left: 3px solid var(--gold-primary);
            padding: 12px;
            margin: 12px 0;
            border-radius: 0 8px 8px 0;
            font-size: 13px;
            font-style: italic;
        }
        html[dir="rtl"] .example-box {
            border-left: none;
            border-right: 3px solid var(--gold-primary);
            border-radius: 8px 0 0 8px;
        }
    </style>
</head>
<body>
    <div class="bg-pattern"></div>
    <div class="toast" id="toast"></div>

    <!-- Premium Status Badge -->
    <div class="premium-badge" id="premiumBadge">
        <span>üëë</span>
        <span>PREMIUM</span>
    </div>

    <!-- Round Counter -->
    <div class="round-counter" id="roundCounter">
        <span id="roundCountDisplay">Runde: 1/5</span>
    </div>

    <!-- Watermark -->
    <div class="watermark">
        <strong>¬© Hans-Swathi Srikandaraja</strong>
        27804 Berne<br>
        <span id="timestamp"></span>
    </div>

    <!-- Support Button -->
    <button class="support-fab" id="supportFab" onclick="game.openSupportModal()">
        <span>‚òï</span>
        <span id="supportText">Unterst√ºtzen</span>
    </button>

    <!-- Bot Moderator -->
    <div id="botBubble" class="bot-moderator">
        <div id="botAvatar" class="bot-avatar">ü§ñ</div>
        <div>
            <div class="bot-name" id="botSpeakerName">AI Moderator</div>
            <div class="bot-text" id="botSpeech">Ready to play?</div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <button class="lang-btn" onclick="game.showLanguageSelect()">üåê <span id="currentLang">DE</span></button>
        </div>
        <div class="pot-indicator" id="potIndicator" onclick="game.showPotDetails()">
            <span>üé∞</span>
            <span id="potText">POT ACTIVE</span>
            <span style="margin-left: 4px;" id="potVideoIcon">üé¨</span>
        </div>
        <div class="header-controls">
            <button class="btn-icon" onclick="game.showDetailedRules()" title="Regeln"><i class="fas fa-book"></i></button>
            <button class="btn-icon" onclick="game.openSupportModal()" title="Premium"><i class="fas fa-crown"></i></button>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        
        <!-- Screen: Start -->
        <div id="startScreen" class="screen active">
            <div class="text-center mt-2">
                <h1 class="main-title">FUNKENFLUG</h1>
                <p class="subtitle" id="subtitle">High Stakes AI Edition v8.1</p>
                
                <div class="feature-tags">
                    <span class="tag">‚ö° <span id="tagModes">5 Modes</span></span>
                    <span class="tag">üé≤ Blackjack</span>
                    <span class="tag">üé¨ <span id="tagVideo">Video Bet</span></span>
                    <span class="tag ai">ü§ñ AI Bots</span>
                    <span class="tag premium" id="premiumTag" style="display: none;">üëë PREMIUM</span>
                </div>

                <!-- Deck Selector -->
                <div class="deck-selector" id="deckSelector">
                    <button class="deck-btn active" onclick="game.selectDeck('classic')" id="btnDeckClassic">Klassik</button>
                    <button class="deck-btn premium-deck locked" onclick="game.selectDeck('nsfw')" id="btnDeckNsfw">NSFW Edition</button>
                    <button class="deck-btn premium-deck locked" onclick="game.selectDeck('tech')" id="btnDeckTech">Tech Edition</button>
                </div>

                <div style="width: 100%; max-width: 320px; margin: 0 auto;">
                    <button class="btn btn-gold btn-large" onclick="game.showLobby()" style="margin-bottom: 12px; height: 56px;" id="btnNewGame">
                        <i class="fas fa-play"></i> <span>Neues Spiel</span>
                    </button>
                    <button class="btn btn-ai" onclick="game.demoMode()" style="margin-bottom: 12px; height: 56px;" id="btnDemo">
                        <i class="fas fa-robot"></i> <span>Demo (Bots)</span>
                    </button>
                    <button class="btn btn-secondary" onclick="game.showDetailedRules()" style="margin-bottom: 12px; height: 56px;" id="btnDetailedRules">
                        <i class="fas fa-book-open"></i> <span>Regeln</span>
                    </button>
                </div>

                <div style="margin-top: 30px; font-size: 12px; color: var(--text-muted); text-align: center; padding: 0 20px;">
                    <span id="freeRoundsText">5 kostenlose Runden verf√ºgbar</span>
                </div>
            </div>
        </div>

        <!-- Screen: Language Selection -->
        <div id="languageScreen" class="screen">
            <div class="glass-card">
                <div style="font-size: 20px; color: var(--gold-primary); margin-bottom: 20px; text-align: center; letter-spacing: 2px;" id="langTitle">SPRACHE W√ÑHLEN</div>
                <div class="lang-grid" id="languageGrid"></div>
                <button class="btn btn-gold" onclick="game.showStart()" id="btnBackLang">Zur√ºck</button>
            </div>
        </div>

        <!-- Screen: Detailed Rules -->
        <div id="rulesScreen" class="screen">
            <div class="glass-card">
                <div style="font-size: 20px; color: var(--gold-primary); margin-bottom: 20px; text-align: center; letter-spacing: 2px;" id="rulesMainTitle">VOLLST√ÑNDIGE REGELN</div>
                
                <div class="step-indicator">
                    <div class="step-dot active" onclick="game.showRulePage(0)"></div>
                    <div class="step-dot" onclick="game.showRulePage(1)"></div>
                    <div class="step-dot" onclick="game.showRulePage(2)"></div>
                    <div class="step-dot" onclick="game.showRulePage(3)"></div>
                </div>

                <div id="rulesContent" class="rules-container"></div>

                <button class="btn btn-gold" onclick="game.showStart()" style="margin-top: 20px;" id="btnBackToMenu">Zur√ºck zum Men√º</button>
            </div>
        </div>

        <!-- Screen: Lobby -->
        <div id="lobbyScreen" class="screen">
            <div class="glass-card">
                <div style="font-size: 20px; color: var(--gold-primary); margin-bottom: 20px; text-align: center; letter-spacing: 2px;" id="lobbyTitle">SPIELER & BOTS</div>
                
                <input type="text" class="input-field" id="playerNameInput" placeholder="Name eingeben...">
                
                <div id="lobbyList" style="margin-bottom: 16px; max-height: 200px; overflow-y: auto;"></div>
                
                <div style="display: flex; gap: 10px; margin-bottom: 12px;">
                    <button class="btn" onclick="game.addPlayer(false)" style="flex: 1;" id="btnAddHuman">+ Mensch</button>
                    <button class="btn btn-ai" onclick="game.addPlayer(true)" style="flex: 1;" id="btnAddBot">+ KI</button>
                </div>
                <button class="btn btn-gold" onclick="game.startGame()" id="btnStart" disabled>Start (Min. 2)</button>
                <button class="btn btn-secondary" onclick="game.showStart()" style="margin-top: 10px;" id="btnBack">Zur√ºck</button>
            </div>
        </div>

        <!-- Screen: Bot Selection -->
        <div id="botScreen" class="screen">
            <h2 class="text-center">KI-Bots ausw√§hlen</h2>
            <p class="subtitle">Jede Pers√∂nlichkeit spielt anders</p>

            <div class="bot-grid">
                <div class="bot-card" data-bot="indica" onclick="game.selectBot('indica')">
                    <div class="bot-avatar">üåø</div>
                    <div class="bot-name">Indica</div>
                    <div class="bot-trait">"Taktisch & Vorsichtig"</div>
                    <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">
                        W√§hlt sichere Optionen, bevorzugt "Wahrheit"
                    </p>
                </div>

                <div class="bot-card" data-bot="sativa" onclick="game.selectBot('sativa')">
                    <div class="bot-avatar">‚ö°</div>
                    <div class="bot-name">Sativa</div>
                    <div class="bot-trait">"Aggressiv & Risikofreudig"</div>
                    <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">
                        Immer f√ºr Herausforderungen bereit, w√§hlt "Pflicht"
                    </p>
                </div>

                <div class="bot-card" data-bot="ruderalis" onclick="game.selectBot('ruderalis')">
                    <div class="bot-avatar">üé≤</div>
                    <div class="bot-name">Ruderalis</div>
                    <div class="bot-trait">"Chaotisch & Unberechenbar"</div>
                    <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">
                        Zuf√§llige Entscheidungen, manchmal brillant
                    </p>
                </div>

                <div class="bot-card" data-bot="hybrid" onclick="game.selectBot('hybrid')">
                    <div class="bot-avatar">üß¨</div>
                    <div class="bot-name">Hybrid</div>
                    <div class="bot-trait">"Adaptiv & Ausgeglichen"</div>
                    <p style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 0.5rem;">
                        Passt sich der Situation an
                    </p>
                    <span class="mode-premium">PRO</span>
                </div>
            </div>

            <div class="glass-card" style="margin-top: 2rem;">
                <h3>Ausgew√§hlte Bots:</h3>
                <div id="selectedBotsList" style="margin-top: 1rem;">
                    <p style="color: var(--text-muted); font-style: italic;">Noch keine Bots ausgew√§hlt...</p>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="game.showLobby()">Zur√ºck</button>
                <button class="btn btn-gold" onclick="game.confirmBots()">Best√§tigen</button>
            </div>
        </div>

        <!-- Screen: Game Mode -->
        <div id="modeScreen" class="screen">
            <h2 class="text-center">Spielmodus w√§hlen</h2>
            <p class="subtitle">Jeder Modus bietet ein einzigartiges Erlebnis</p>

            <div class="mode-grid">
                <div class="mode-card" data-mode="classic" onclick="game.selectMode('classic')">
                    <div class="mode-icon"><i class="fas fa-random"></i></div>
                    <div class="mode-title">Classic</div>
                    <div class="mode-desc">Wahrheit oder Pflicht mit allen Kartentypen gemischt</div>
                </div>

                <div class="mode-card" data-mode="wheel" onclick="game.selectMode('wheel')">
                    <div class="mode-icon"><i class="fas fa-dharmachakra"></i></div>
                    <div class="mode-title">Wheel Master</div>
                    <div class="mode-desc">Das 4-Ring-Rad bestimmt dein Schicksal komplett</div>
                </div>

                <div class="mode-card" data-mode="quiz" onclick="game.selectMode('quiz')">
                    <div class="mode-icon"><i class="fas fa-brain"></i></div>
                    <div class="mode-title">Quiz Battle</div>
                    <div class="mode-desc">Nur Quizfragen - teste dein Wissen</div>
                </div>

                <div class="mode-card" data-mode="blackjack" onclick="game.selectMode('blackjack')">
                    <div class="mode-icon"><i class="fas fa-cards"></i></div>
                    <div class="mode-title">Risk 21</div>
                    <div class="mode-desc">Blackjack trifft auf Wahrheit oder Pflicht</div>
                </div>

                <div class="mode-card" data-mode="chaos" onclick="game.selectMode('chaos')">
                    <div class="mode-icon"><i class="fas fa-bolt"></i></div>
                    <div class="mode-title">Chaos Mode</div>
                    <div class="mode-desc">Nur Chaos-Karten - pure Unvorhersehbarkeit</div>
                    <span class="mode-premium">PRO</span>
                </div>
            </div>

            <div class="btn-group">
                <button class="btn btn-secondary" onclick="game.showLobby()">Zur√ºck</button>
                <button class="btn btn-gold" id="modeNextBtn" onclick="game.showGame()" disabled>Weiter</button>
            </div>
        </div>

        <!-- Screen: Game -->
        <div id="gameScreen" class="screen">
            <!-- Wheel View -->
            <div id="wheelView" style="display: none;">
                <div class="text-center">
                    <h2 id="currentPlayerName" style="margin-bottom: 1rem;">Spieler ist dran!</h2>
                    <div class="wheel-container" style="transform: scale(0.9);">
                        <div class="wheel-pointer"></div>
                        <div class="wheel-ring wheel-ring-outer" id="ringOuter"></div>
                        <div class="wheel-ring wheel-ring-mid" id="ringMid"></div>
                        <div class="wheel-ring wheel-ring-inner" id="ringInner"></div>
                        <div class="wheel-ring wheel-ring-core" id="ringCore">GO</div>
                    </div>
                    <button class="btn btn-gold spin-btn" onclick="game.spinWheel()" id="spinBtn">
                        <i class="fas fa-sync-alt"></i> Rad drehen
                    </button>
                    <div id="spinResult" style="margin-top: 2rem; min-height: 100px;"></div>
                </div>
            </div>

            <!-- Card View -->
            <div id="cardView">
                <div id="card-action" class="game-card">
                    <div class="card-glow"></div>
                    <div class="card-type-badge" style="background: var(--gold-primary);">‚ö° AKTION</div>
                    <div class="card-content" id="text-action"></div>
                    <div class="btn-group">
                        <button class="btn btn-success" onclick="game.success()">Geschafft ‚úì</button>
                        <button class="btn btn-danger" onclick="game.fail()">Nicht geschafft ‚úó</button>
                    </div>
                </div>

                <div id="card-quiz" class="game-card">
                    <div class="card-glow" style="background: linear-gradient(90deg, transparent, var(--accent-blue), transparent);"></div>
                    <div class="card-type-badge" style="background: var(--accent-blue);">üß† QUIZ</div>
                    <div class="timer-bar"><div class="timer-progress" id="quizTimer"></div></div>
                    <div class="card-content" id="text-quiz" style="font-size: 20px;"></div>
                    <div class="quiz-options" id="quiz-options"></div>
                    <div id="quiz-feedback" style="margin-top: 15px; font-size: 14px; font-weight: 600; height: 20px;"></div>
                </div>

                <div id="card-tabu" class="game-card">
                    <div class="card-glow" style="background: linear-gradient(90deg, transparent, var(--accent-green), transparent);"></div>
                    <div class="card-type-badge" style="background: var(--accent-green);">üö´ TABU</div>
                    <div class="card-content" id="text-tabu" style="font-size: 28px; font-weight: 600; text-transform: uppercase;"></div>
                    <div class="tabu-forbidden" id="list-tabu"></div>
                    <div class="btn-group" style="margin-top: 20px;">
                        <button class="btn btn-success" onclick="game.success()">Erraten ‚úì</button>
                        <button class="btn btn-danger" onclick="game.fail()">Zeit abgelaufen ‚úó</button>
                    </div>
                </div>

                <div id="card-z" class="game-card">
                    <div class="card-glow" style="background: linear-gradient(90deg, transparent, var(--accent-red), transparent);"></div>
                    <div class="card-type-badge" style="background: var(--accent-red);">üî• Z√úNDSTOFF</div>
                    <div class="card-content" id="text-z" style="font-size: 22px;"></div>
                    <div class="btn-group">
                        <button class="btn btn-success" onclick="game.success()">Beantwortet ‚úì</button>
                        <button class="btn btn-danger" onclick="game.fail()">Verweigert ‚úó</button>
                    </div>
                </div>

                <div id="card-chaos" class="game-card">
                    <div class="card-glow" style="background: linear-gradient(90deg, transparent, #ff00ff, transparent);"></div>
                    <div class="card-type-badge" style="background: #ff00ff;">‚ö†Ô∏è CHAOS</div>
                    <div class="card-content" id="text-chaos" style="color: #ff00ff; font-size: 20px;"></div>
                    <div id="sub-chaos" style="color: var(--text-secondary); font-size: 14px; margin-top: 10px;"></div>
                    <button class="btn btn-gold" onclick="game.next()" style="margin-top: 20px;">Weiter ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Screen: Results -->
        <div id="resultScreen" class="screen">
            <div class="glass-card" style="text-align: center;">
                <div style="font-size: 48px; margin-bottom: 10px;">üèÜ</div>
                <div style="font-size: 14px; color: var(--text-secondary); letter-spacing: 4px; margin-bottom: 10px;" id="winnerTitle">GEWINNER</div>
                <div id="winnerName" style="font-size: 28px; color: var(--gold-primary); font-weight: 300; margin-bottom: 30px;">-</div>
                
                <div id="finalScores" style="margin: 20px 0; text-align: left;"></div>
                
                <button class="btn btn-gold" onclick="game.nextRound()" style="margin-bottom: 10px;" id="btnNextRound">N√§chste Runde</button>
                <button class="btn btn-secondary" onclick="game.showStart()" id="btnMainMenu">Hauptmen√º</button>
            </div>
        </div>

    </div>

    <!-- Player Queue -->
    <div class="player-queue hidden" id="playerQueue"></div>

    <!-- FAB Container -->
    <div class="fab-container" id="fabContainer" style="display: none; position: fixed; bottom: 0; left: 0; right: 0; padding: 20px; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); z-index: 40;">
        <button class="btn btn-video" onclick="game.showBj()" id="btnHighStakes" style="display: none; margin-bottom: 10px;">
            üé¨ High Stakes (1 Item)
        </button>
        <div class="btn-group" id="gameControls">
            <button class="btn btn-danger" onclick="game.fail()" id="btnFail">Nicht geschafft</button>
            <button class="btn btn-success" onclick="game.success()" id="btnSuccess">Geschafft ‚úì</button>
        </div>
        <button class="btn btn-gold" onclick="game.next()" id="btnNext" style="display: none; margin-top: 10px;">Weiter ‚Üí</button>
        <button class="btn btn-secondary" onclick="game.showStart()" style="margin-top: 8px;">Men√º</button>
    </div>

    <!-- Bet Modal -->
    <div id="modal-bet" class="modal">
        <div class="bet-interface video">
            <button class="close-modal" onclick="game.closeBetModal()"><i class="fas fa-times"></i></button>
            <div class="bet-title video">üé¨ High Stakes Video</div>
            <div class="bet-info">Du hast nur noch <span id="remainingItems">1</span> Item!</div>
            
            <div class="video-input-group">
                <label class="video-label">üìπ Video URL (optional)</label>
                <input type="text" class="video-input" id="videoUrlInput" placeholder="https://..." oninput="game.updateVideoPreview()">
                <div class="video-hint">Wird bei Verlust an Gewinner weitergegeben</div>
                <div class="video-preview" id="videoPreview"></div>
            </div>

            <div style="display: flex; gap: 10px; margin: 20px 0;">
                <button class="btn" onclick="game.setBetRounds(1)" style="flex: 1;" id="btnRound1">1 Runde</button>
                <button class="btn" onclick="game.setBetRounds(3)" style="flex: 1;" id="btnRound3">3 Runden</button>
            </div>
            
            <div id="betSummary" style="font-size: 13px; color: var(--video); text-align: center; margin-bottom: 20px; font-weight: 600;">W√§hle die Dauer</div>
            
            <button class="btn btn-video" onclick="game.confirmBet()" id="btnConfirmBet" style="margin-bottom: 10px;">üé¨ Einsatz setzen</button>
            <button class="btn btn-danger" onclick="game.fold()" id="btnFold">Aufgeben (Out)</button>
        </div>
    </div>

    <!-- Challenge Modal -->
    <div id="modal-challenge" class="modal">
        <div class="bet-interface" style="border-color: var(--accent-red);">
            <div class="bet-title" style="color: var(--accent-red);">‚öîÔ∏è HERAUSFORDERUNG!</div>
            <div style="text-align: center; font-size: 14px; margin-bottom: 20px;">
                <span id="challengePlayerName" style="color: var(--gold-primary); font-weight: 700;"></span> hat einen Einsatz gesetzt!
            </div>
            
            <div id="challengeVideoBox" style="background: rgba(255, 0, 102, 0.1); border: 1px solid rgba(255, 0, 102, 0.3); border-radius: 12px; padding: 16px; margin: 16px 0; word-break: break-all; font-size: 13px; color: var(--video); display: none;">
                üé¨ Video Einsatz aktiv
            </div>

            <div style="font-size: 13px; color: var(--text-secondary); margin-bottom: 20px; text-align: center;">
                Fordere ihn zum Blackjack-Duell heraus!
            </div>

            <button class="btn btn-success" onclick="game.acceptChallenge()" style="margin-bottom: 10px;">Herausfordern (Blackjack)</button>
            <button class="btn btn-secondary" onclick="game.declineChallenge()">Ablehnen</button>
        </div>
    </div>

    <!-- Blackjack Modal -->
    <div id="modal-bj" class="modal">
        <div class="glass-card" style="max-width: 360px;">
            <div style="text-align: center; margin-bottom: 20px;">
                <div style="font-size: 12px; color: var(--gold-primary); letter-spacing: 2px;">HIGH STAKES</div>
                <div style="font-size: 24px; font-weight: 700; font-family: 'Cinzel', serif;">üé∞ BLACKJACK</div>
                <div id="bjRoundInfo" style="font-size: 11px; color: var(--text-secondary);">Runde 1/1</div>
            </div>

            <div class="blackjack-table" style="padding: 15px; margin-bottom: 15px;">
                <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">
                    <span id="bjOppName">Gegner</span>
                    <span id="bjOppScore" style="color: var(--gold-primary); font-weight: 700;">?</span>
                </div>
                <div class="cards" id="bjOppHand"></div>
            </div>

            <div class="blackjack-table" style="border-color: var(--gold-primary); padding: 15px;">
                <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--text-secondary); margin-bottom: 10px;">
                    <span id="bjYou">DU</span>
                    <span id="bjPlayerScore" style="color: var(--gold-primary); font-weight: 700;">0</span>
                </div>
                <div class="cards" id="bjPlayerHand"></div>
            </div>

            <div class="btn-group" style="margin-top: 20px;">
                <button class="btn btn-secondary" onclick="game.bjStand()" style="height: 50px;">STOP</button>
                <button class="btn btn-gold" onclick="game.bjHit()" style="height: 50px;">KARTE</button>
            </div>
        </div>
    </div>

    <!-- Premium Modal -->
    <div id="modal-premium" class="modal">
        <div class="glass-card" style="max-width: 450px;">
            <button class="close-modal" onclick="game.closeSupportModal()"><i class="fas fa-times"></i></button>
            
            <div style="text-align: center; margin-bottom: 20px;">
                <h2 style="color: var(--gold-primary); font-size: 24px; text-transform: uppercase; letter-spacing: 2px;">üî• Premium</h2>
                <p style="color: var(--text-secondary); font-size: 14px;" id="premiumModalText">Unterst√ºtze die Entwicklung!</p>
            </div>

            <div class="features-grid">
                <div class="feature-card unlocked" id="featureClassic">
                    <div class="feature-icon">üéÆ</div>
                    <div class="feature-info">
                        <h3>Klassik Deck</h3>
                        <p>50+ Standard-Aufgaben</p>
                    </div>
                </div>

                <div class="feature-card locked" id="featureNsfw">
                    <div class="feature-icon">üîû</div>
                    <div class="feature-info">
                        <h3>NSFW Edition</h3>
                        <p>Extra freiz√ºgige Aufgaben</p>
                    </div>
                </div>

                <div class="feature-card locked" id="featureTech">
                    <div class="feature-icon">üíª</div>
                    <div class="feature-info">
                        <h3>Tech Edition</h3>
                        <p>IT & Developer Inside-Jokes</p>
                    </div>
                </div>

                <div class="feature-card locked" id="featureUnlimited">
                    <div class="feature-icon">‚àû</div>
                    <div class="feature-info">
                        <h3>Unbegrenzte Runden</h3>
                        <p>Spiele ohne Limit</p>
                    </div>
                </div>
            </div>

            <a href="https://www.paypal.me/HansSwathiSrikandaraja" target="_blank" class="btn btn-gold" style="margin-top: 20px; text-decoration: none;" onclick="game.activatePremium()">
                <span>‚òï</span>
                <span id="paypalBtnText">Ein Bier spendieren (5‚Ç¨)</span>
            </a>

            <div style="margin-top: 15px; text-align: center; font-size: 12px; color: var(--text-secondary);">
                <span id="cryptoText">oder</span> <a href="#" onclick="game.showCryptoOptions()" style="color: var(--gold-primary);">Crypto</a>
            </div>

            <div style="margin-top: 20px; padding: 15px; background: rgba(212, 175, 55, 0.1); border-radius: 10px; border-left: 3px solid var(--gold-primary); font-size: 12px; color: var(--text-secondary);">
                <strong style="color: var(--gold-primary);">Hinweis:</strong> Premium ist danach dauerhaft aktiv.
            </div>
        </div>
    </div>

    <script>
        // ==================== COMPLETE RULES DATABASE ====================
        const RULES_DATABASE = {
            de: {
                mainTitle: "VOLLST√ÑNDIGE REGELN",
                btnBack: "Zur√ºck zum Men√º",
                pages: [
                    {
                        title: "üéÆ SPIELZIEL & GRUNDLAGEN",
                        content: `
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üèÜ</span> Ziel</div>
                                <p>√úberstehe mit den <span class="highlight">meisten Kleidungsst√ºcken</span>. Der letzte Spieler mit Kleidung gewinnt.</p>
                                <div class="example-box">
                                    <strong>Start:</strong> 5 Items (Schuhe, Socken, Oberteil, Hose, Unterw√§sche). Bei Fehler: -1 Item!
                                </div>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üë•</span> Spieler</div>
                                <ul class="rules-list">
                                    <li>Mindestens <span class="highlight">2 Spieler</span> (max. 8)</li>
                                    <li>Menschlich oder <span class="highlight">KI-Bots</span></li>
                                    <li>Jeder startet mit <span class="highlight">5 Items</span></li>
                                </ul>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üé≤</span> Ablauf</div>
                                <ol class="rules-list">
                                    <li>W√ºrfle/Rad f√ºr Kategorie</li>
                                    <li>Lies die Aufgabe vor</li>
                                    <li>F√ºhre aus oder w√§hle "Nicht geschafft"</li>
                                    <li>Bei Erfolg: n√§chster Spieler</li>
                                    <li>Bei Misserfolg: <span class="danger-highlight">-1 Item</span></li>
                                </ol>
                            </div>
                        `
                    },
                    {
                        title: "üÉè KARTENTYPEN",
                        content: `
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: var(--gold-primary);">‚ö° AKTION</span></div>
                                <p>K√∂rperliche/soziale Herausforderungen. Sofort ausf√ºhren!</p>
                                <div class="example-box">Tausche Oberteil, Lass dich kitzeln, Trinke ohne H√§nde</div>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: var(--accent-blue);">üß† QUIZ</span></div>
                                <p>Allgemeinwissen mit 3 Antworten. Ein Versuch!</p>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: var(--accent-green);">üö´ TABU</span></div>
                                <p>Erkl√§re das Wort <span class="danger-highlight">ohne</span> verbotene Begriffe! 60 Sekunden Zeit.</p>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: var(--accent-red);">üî• Z√úNDSTOFF</span></div>
                                <p>Intime/pers√∂nliche Fragen. Weigerung = Strip!</p>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: #ff00ff;">‚ö†Ô∏è CHAOS</span></div>
                                <p>√Ñndert Regeln: Doppelter Einsatz, Rollentausch, etc.</p>
                            </div>
                        `
                    },
                    {
                        title: "üé¨ HIGH STAKES",
                        content: `
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üö®</span> Kritisch!</div>
                                <p>Bei <span class="danger-highlight">1 Item</span> aktiviert sich <span class="video-highlight">HIGH STAKES</span>!</p>
                                <div class="example-box">Setze einen Video-Link (YouTube/TikTok) als Einsatz.</div>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üé∞</span> Blackjack</div>
                                <p>Spiele gegen das System:</p>
                                <ul class="rules-list">
                                    <li>Ziel: N√§her an <span class="highlight">21</span></li>
                                    <li>√úber 21 = Verlust (Bust)</li>
                                    <li>Ass = 1 oder 11</li>
                                </ul>
                                <p>Gewinn: Behalte Items. Verlust: Video geht an Gewinner!</p>
                            </div>
                        `
                    },
                    {
                        title: "üëë PREMIUM",
                        content: `
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üîì</span> Features</div>
                                <ul class="rules-list">
                                    <li><span class="highlight">NSFW Deck:</span> Freiz√ºgige Aufgaben</li>
                                    <li><span class="highlight">Tech Deck:</span> IT/Programmierer-Jokes</li>
                                    <li><span class="highlight">Unbegrenzt:</span> Kein 5-Runden-Limit</li>
                                    <li><span class="highlight">Chaos Mode:</span> Nur Chaos-Karten</li>
                                </ul>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">ü§ñ</span> Bots</div>
                                <p><strong>Indica:</strong> Vorsichtig | <strong>Sativa:</strong> Risikofreudig<br>
                                <strong>Ruderalis:</strong> Chaotisch | <strong>Hybrid:</strong> Adaptiv</p>
                            </div>
                        `
                    }
                ]
            },
            en: {
                mainTitle: "COMPLETE RULES",
                btnBack: "Back to Menu",
                pages: [
                    {
                        title: "üéÆ OBJECTIVE & BASICS",
                        content: `
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üèÜ</span> Goal</div>
                                <p>Survive with the <span class="highlight">most clothing items</span>. Last player with clothes wins.</p>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üë•</span> Players</div>
                                <ul class="rules-list">
                                    <li>Minimum <span class="highlight">2 players</span> (max 8)</li>
                                    <li>Human or <span class="highlight">AI Bots</span></li>
                                    <li>Each starts with <span class="highlight">5 items</span></li>
                                </ul>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üé≤</span> Flow</div>
                                <ol class="rules-list">
                                    <li>Spin wheel for category</li>
                                    <li>Read task aloud</li>
                                    <li>Perform or "Failed"</li>
                                    <li>Success: next player</li>
                                    <li>Failure: <span class="danger-highlight">-1 Item</span></li>
                                </ol>
                            </div>
                        `
                    },
                    {
                        title: "üÉè CARD TYPES",
                        content: `
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: var(--gold-primary);">‚ö° ACTION</span></div>
                                <p>Physical/social challenges. Execute immediately!</p>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: var(--accent-blue);">üß† QUIZ</span></div>
                                <p>General knowledge, 3 answers. One try!</p>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: var(--accent-green);">üö´ TABOO</span></div>
                                <p>Explain word <span class="danger-highlight">without</span> forbidden terms! 60 seconds.</p>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: var(--accent-red);">üî• Z√úNDSTOFF</span></div>
                                <p>Intimate questions. Refusal = Strip!</p>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span style="color: #ff00ff;">‚ö†Ô∏è CHAOS</span></div>
                                <p>Changes rules: Double strip, reverse, etc.</p>
                            </div>
                        `
                    },
                    {
                        title: "üé¨ HIGH STAKES",
                        content: `
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üö®</span> Critical!</div>
                                <p>At <span class="danger-highlight">1 Item</span>, <span class="video-highlight">HIGH STAKES</span> activates!</p>
                                <p>Bet a video link (YouTube/TikTok) to survive.</p>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üé∞</span> Blackjack</div>
                                <p>Play against system:</p>
                                <ul class="rules-list">
                                    <li>Goal: Closer to <span class="highlight">21</span></li>
                                    <li>Over 21 = Bust (Loss)</li>
                                    <li>Ace = 1 or 11</li>
                                </ul>
                            </div>
                        `
                    },
                    {
                        title: "üëë PREMIUM",
                        content: `
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">üîì</span> Features</div>
                                <ul class="rules-list">
                                    <li><span class="highlight">NSFW Deck:</span> Explicit tasks</li>
                                    <li><span class="highlight">Tech Deck:</span> IT jokes</li>
                                    <li><span class="highlight">Unlimited:</span> No round limit</li>
                                    <li><span class="highlight">Chaos Mode:</span> Chaos only</li>
                                </ul>
                            </div>
                            <div class="rules-section">
                                <div class="rules-title"><span class="rules-icon">ü§ñ</span> Bots</div>
                                <p><strong>Indica:</strong> Safe | <strong>Sativa:</strong> Risky<br>
                                <strong>Ruderalis:</strong> Random | <strong>Hybrid:</strong> Adaptive</p>
                            </div>
                        `
                    }
                ]
            }
        };

        // ==================== TRANSLATIONS ====================
        const TRANSLATIONS = {
            de: {
                code: "DE", name: "Deutsch", flag: "üá©üá™", dir: "ltr",
                subtitle: "High Stakes AI Edition v8.1",
                tagModes: "5 Modi", tagVideo: "Video Einsatz",
                btnNewGame: "Neues Spiel", btnDemo: "Demo (Bots)", btnDetailedRules: "Regeln",
                lobbyTitle: "SPIELER & BOTS", btnAddHuman: "+ Mensch", btnAddBot: "+ KI", btnStart: "Start (Min. 2)", btnBack: "Zur√ºck",
                rulesMainTitle: "VOLLST√ÑNDIGE REGELN", btnBackToMenu: "Zur√ºck zum Men√º",
                langTitle: "SPRACHE W√ÑHLEN", btnBackLang: "Zur√ºck",
                freeRoundsText: "5 kostenlose Runden verf√ºgbar",
                winnerTitle: "GEWINNER", btnNextRound: "N√§chste Runde", btnMainMenu: "Hauptmen√º",
                toast: { correct: "‚úÖ Richtig!", wrong: "‚ùå Falsch!", won: "üèÜ Gewonnen!", lost: "‚ùå Verloren!", videoSet: "üé¨ Video gesetzt!", premium: "üéâ Premium aktiviert!" }
            },
            en: {
                code: "EN", name: "English", flag: "üá¨üáß", dir: "ltr",
                subtitle: "High Stakes AI Edition v8.1",
                tagModes: "5 Modes", tagVideo: "Video Bet",
                btnNewGame: "New Game", btnDemo: "Demo (Bots)", btnDetailedRules: "Rules",
                lobbyTitle: "PLAYERS & BOTS", btnAddHuman: "+ Human", btnAddBot: "+ AI", btnStart: "Start (Min. 2)", btnBack: "Back",
                rulesMainTitle: "COMPLETE RULES", btnBackToMenu: "Back to Menu",
                langTitle: "SELECT LANGUAGE", btnBackLang: "Back",
                freeRoundsText: "5 free rounds available",
                winnerTitle: "WINNER", btnNextRound: "Next Round", btnMainMenu: "Main Menu",
                toast: { correct: "‚úÖ Correct!", wrong: "‚ùå Wrong!", won: "üèÜ Won!", lost: "‚ùå Lost!", videoSet: "üé¨ Video bet placed!", premium: "üéâ Premium activated!" }
            },
            fr: { code: "FR", name: "Fran√ßais", flag: "üá´üá∑", dir: "ltr", subtitle: "√âdition Haute Enjeux" },
            es: { code: "ES", name: "Espa√±ol", flag: "üá™üá∏", dir: "ltr", subtitle: "Edici√≥n Alto Riesgo" },
            it: { code: "IT", name: "Italiano", flag: "üáÆüáπ", dir: "ltr", subtitle: "Edizione Alto Rischio" },
            pt: { code: "PT", name: "Portugu√™s", flag: "üáµüáπ", dir: "ltr", subtitle: "Edi√ß√£o Alto Risco" },
            pl: { code: "PL", name: "Polski", flag: "üáµüá±", dir: "ltr", subtitle: "Edycja Wysokie Ryzyko" },
            nl: { code: "NL", name: "Nederlands", flag: "üá≥üá±", dir: "ltr", subtitle: "High Stakes Editie" },
            tr: { code: "TR", name: "T√ºrk√ße", flag: "üáπüá∑", dir: "ltr", subtitle: "Y√ºksek Bahisler" },
            el: { code: "EL", name: "ŒïŒªŒªŒ∑ŒΩŒπŒ∫Œ¨", flag: "üá¨üá∑", dir: "ltr", subtitle: "ŒàŒ∫Œ¥ŒøœÉŒ∑ Œ•œàŒ∑ŒªœéŒΩ Œ£œÑŒøŒπœáŒ∑ŒºŒ¨œÑœâŒΩ" },
            ar: { code: "AR", name: "ÿßŸÑÿπÿ±ÿ®Ÿäÿ©", flag: "üá∏üá¶", dir: "rtl", subtitle: "ŸÜÿ≥ÿÆÿ© ÿßŸÑŸÖÿÆÿßÿ∑ÿ± ÿßŸÑÿπÿßŸÑŸäÿ©" },
            zh: { code: "ZH", name: "‰∏≠Êñá", flag: "üá®üá≥", dir: "ltr", subtitle: "È´òÈ£éÈô©Áâà" },
            hi: { code: "HI", name: "‡§π‡§ø‡§®‡•ç‡§¶‡•Ä", flag: "üáÆüá≥", dir: "ltr", subtitle: "‡§π‡§æ‡§à ‡§∏‡•ç‡§ü‡•á‡§ï‡•ç‡§∏ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£" },
            ja: { code: "JA", name: "Êó•Êú¨Ë™û", flag: "üáØüáµ", dir: "ltr", subtitle: "„Éè„Ç§„Çπ„ÉÜ„Éº„ÇØ„ÇπÁâà" },
            ko: { code: "KO", name: "ÌïúÍµ≠Ïñ¥", flag: "üá∞üá∑", dir: "ltr", subtitle: "ÌïòÏù¥Ïä§ÌÖåÏù¥ÌÅ¨ ÏóêÎîîÏÖò" },
            ru: { code: "RU", name: "–†—É—Å—Å–∫–∏–π", flag: "üá∑üá∫", dir: "ltr", subtitle: "–í—ã—Å–æ–∫–∏–µ –°—Ç–∞–≤–∫–∏" },
            sv: { code: "SV", name: "Svenska", flag: "üá∏üá™", dir: "ltr", subtitle: "High Stakes" },
            no: { code: "NO", name: "Norsk", flag: "üá≥üá¥", dir: "ltr", subtitle: "High Stakes" },
            da: { code: "DA", name: "Dansk", flag: "üá©üá∞", dir: "ltr", subtitle: "High Stakes" },
            fi: { code: "FI", name: "Suomi", flag: "üá´üáÆ", dir: "ltr", subtitle: "High Stakes" },
            cs: { code: "CS", name: "ƒåe≈°tina", flag: "üá®üáø", dir: "ltr", subtitle: "High Stakes" },
            hu: { code: "HU", name: "Magyar", flag: "üá≠üá∫", dir: "ltr", subtitle: "High Stakes" },
            ro: { code: "RO", name: "Rom√¢nƒÉ", flag: "üá∑üá¥", dir: "ltr", subtitle: "High Stakes" },
            sk: { code: "SK", name: "Slovenƒçina", flag: "üá∏üá∞", dir: "ltr", subtitle: "High Stakes" }
        };

        // ==================== GAME DATA ====================
        const DECKS = {
            de: {
                classic: {
                    actions: ["Tausche Oberteil mit links","Lass dich 30s kitzeln","Fl√ºstere ein Geheimnis","Trinke ohne H√§nde","Mach ein Kompliment","Ziehe etwas aus","Wahrheit oder Strip?","Sexy Werbung"],
                    quiz: [
                        {q: "Schritte pro Tag (Durchschnitt)?", a: ["3.000", "10.000", "15.000"], c: 1},
                        {q: "Gr√∂√ütes inn. Organ?", a: ["Herz", "Leber", "Lunge"], c: 1},
                        {q: "Z√§hne Erwachsener?", a: ["28", "32", "36"], c: 1},
                        {q: "Erstes iPhone Jahr?", a: ["2005", "2007", "2009"], c: 1}
                    ],
                    tabu: [
                        {w: "Orgasmus", f: ["H√∂hepunkt", "Lust", "Kommen"]},
                        {w: "Kondom", f: ["Gummi", "Schutz", "Verh√ºtung"]},
                        {w: "Tinder", f: ["Dating", "Swipe", "Match"]}
                    ],
                    zundstoff: ["Geheimste Fantasie?","Mit wem hier schlafen?","Verruchteste Tat?","Letzter Sex-Traum?"],
                    chaos: [
                        {n: "DOPPELTER EINSATZ", d: "Strips verdoppelt!", e: "double"},
                        {n: "ROLLENTAUSCH", d: "Richtung umgekehrt!", e: "reverse"},
                        {n: "ZWANGS-BLACKJACK", d: "Nur Blackjack rettet!", e: "bjforced"}
                    ]
                },
                nsfw: {
                    actions: ["Zeige dein bestes Dirty Talk","Mache einen verf√ºhrerischen Tanz","K√ºsse den Spieler links","F√ºhre eine erotische Geste aus"],
                    quiz: [{q: "Wie lange dauert Sex durchschn.?", a: ["5 Min", "15 Min", "45 Min"], c: 1}],
                    tabu: [{w: "Oralverkehr", f: ["Blasen", "Lecken", "69"]}],
                    zundstoff: ["Lieblingsstellung?","Gr√∂√ütes sexuelles Missgeschick?"],
                    chaos: [{n: "EXTREM", d: "Strips x3!", e: "triple"}]
                },
                tech: {
                    actions: ["Erkl√§re Kubernetes","Simuliere einen Bugfix","Mache einen Programmierer-Witz"],
                    quiz: [{q: "Was bedeutet HTML?", a: ["How To Meet Ladies", "HyperText Markup Language", "High Tech"], c: 1}],
                    tabu: [{w: "Algorithmus", f: ["Code", "Sortieren", "Logik"]}],
                    zundstoff: ["Schlimmster Bug im Bett?","Mit welchem Tech-CEO schlafen?"],
                    chaos: [{n: "SERVER DOWN", d: "Niemand darf sprechen!", e: "silent"}]
                }
            },
            en: {
                classic: {
                    actions: ["Swap shirt with left","Get tickled 30s","Whisper a secret","Drink no hands","Naughty compliment","Take something off"],
                    quiz: [{q: "Steps per day (avg)?", a: ["3,000", "10,000", "15,000"], c: 1}],
                    tabu: [{w: "Orgasm", f: ["Climax", "Pleasure", "Come"]}],
                    zundstoff: ["Secret fantasy?","Who here sleep with?","Naughtiest done?"],
                    chaos: [{n: "DOUBLE STRIP", d: "Strips doubled!", e: "double"}]
                },
                nsfw: {
                    actions: ["Show best dirty talk","Do a seductive dance","Kiss player on left"],
                    quiz: [{q: "Average sex duration?", a: ["5 min", "15 min", "45 min"], c: 1}],
                    tabu: [{w: "Oral sex", f: ["Blow", "Lick", "69"]}],
                    zundstoff: ["Favorite position?","Biggest sexual mishap?"],
                    chaos: [{n: "EXTREME", d: "Strips x3!", e: "triple"}]
                },
                tech: {
                    actions: ["Explain Kubernetes","Simulate a bugfix","Make a programmer joke"],
                    quiz: [{q: "What is HTML?", a: ["How To Meet Ladies", "HyperText Markup Language", "High Tech"], c: 1}],
                    tabu: [{w: "Algorithm", f: ["Code", "Sort", "Logic"]}],
                    zundstoff: ["Worst bug in bed?","Which tech CEO sleep with?"],
                    chaos: [{n: "SERVER DOWN", d: "No one may speak!", e: "silent"}]
                }
            }
        };

        // ==================== GAME CONTROLLER ====================
        class GameController {
            constructor() {
                this.players = [];
                this.currentPlayerIdx = 0;
                this.round = 1;
                this.gameActive = false;
                this.currentCard = null;
                this.currentMode = 'classic';
                this.selectedBots = [];
                
                // Premium / Freemium
                this.isPremium = localStorage.getItem('funkenflug_premium') === 'true';
                this.roundsInCurrentGame = 0;
                this.currentDeck = 'classic';
                
                // High Stakes
                this.bjRounds = 0;
                this.bjGame = null;
                this.potActive = false;
                this.betPlayer = null;
                this.currentVideoUrl = '';
                this.stripMultiplier = 1;
                this.reverseDirection = false;
                this.isChallenge = false;
                
                // Language
                this.lang = localStorage.getItem('funkenflug_lang') || 'de';
                this.currentRulePage = 0;
                
                // Bot personalities
                this.botTypes = {
                    indica: { name: 'Indica', avatar: 'üåø', risk: 0.3 },
                    sativa: { name: 'Sativa', avatar: '‚ö°', risk: 0.8 },
                    ruderalis: { name: 'Ruderalis', avatar: 'üé≤', risk: 0.5 },
                    hybrid: { name: 'Hybrid', avatar: 'üß¨', risk: 0.6 }
                };
            }

            init() {
                this.generateLanguageGrid();
                this.setLanguage(this.lang, false);
                this.updateTimestamp();
                this.updatePremiumUI();
                setInterval(() => this.updateTimestamp(), 60000);
                
                // Setup event listeners
                document.getElementById('playerNameInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.addPlayer(false);
                });
            }

            // ==================== NAVIGATION ====================
            showScreen(screenId) {
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                document.getElementById(screenId).classList.add('active');
                
                if (screenId === 'gameScreen') {
                    document.getElementById('fabContainer').style.display = 'flex';
                    document.getElementById('playerQueue').classList.remove('hidden');
                } else {
                    document.getElementById('fabContainer').style.display = 'none';
                    document.getElementById('playerQueue').classList.add('hidden');
                }
            }

            showStart() { this.showScreen('startScreen'); }
            showLanguageSelect() { this.showScreen('languageScreen'); }
            showDetailedRules() { this.currentRulePage = 0; this.renderRulesPage(); this.showScreen('rulesScreen'); }
            showLobby() { this.showScreen('lobbyScreen'); this.updateLobby(); }
            showGame() { 
                if (!this.currentMode) return;
                this.showScreen('gameScreen'); 
                this.startGameLoop(); 
            }

            // ==================== PREMIUM ====================
            updatePremiumUI() {
                const badge = document.getElementById('premiumBadge');
                const premiumTag = document.getElementById('premiumTag');
                
                if (this.isPremium) {
                    badge.classList.add('active');
                    premiumTag.style.display = 'inline-block';
                    document.getElementById('featureNsfw').classList.remove('locked');
                    document.getElementById('featureNsfw').classList.add('unlocked');
                    document.getElementById('featureTech').classList.remove('locked');
                    document.getElementById('featureTech').classList.add('unlocked');
                    document.getElementById('featureUnlimited').classList.remove('locked');
                    document.getElementById('featureUnlimited').classList.add('unlocked');
                    document.getElementById('btnDeckNsfw').classList.remove('locked');
                    document.getElementById('btnDeckTech').classList.remove('locked');
                    document.getElementById('freeRoundsText').style.display = 'none';
                    document.getElementById('roundCounter').style.display = 'none';
                } else {
                    badge.classList.remove('active');
                    premiumTag.style.display = 'none';
                    document.getElementById('freeRoundsText').style.display = 'block';
                    document.getElementById('roundCounter').style.display = 'block';
                }
                this.updateRoundDisplay();
            }

            updateRoundDisplay() {
                if (!this.isPremium) {
                    const remaining = Math.max(0, 5 - this.roundsInCurrentGame);
                    document.getElementById('roundCountDisplay').innerText = `Runde: ${this.roundsInCurrentGame}/5`;
                    document.getElementById('freeRoundsText').innerText = `${remaining} kostenlose Runden verf√ºgbar`;
                }
            }

            selectDeck(deckType) {
                if ((deckType === 'nsfw' || deckType === 'tech') && !this.isPremium) {
                    this.openSupportModal();
                    return;
                }
                this.currentDeck = deckType;
                document.querySelectorAll('.deck-btn').forEach(btn => btn.classList.remove('active'));
                document.getElementById(`btnDeck${deckType.charAt(0).toUpperCase() + deckType.slice(1)}`).classList.add('active');
                this.showToast(`${deckType.toUpperCase()} Deck ausgew√§hlt`, 'success');
            }

            openSupportModal() { document.getElementById('modal-premium').classList.add('active'); }
            closeSupportModal() { document.getElementById('modal-premium').classList.remove('active'); }
            closeBetModal() { document.getElementById('modal-bet').classList.remove('active'); }

            activatePremium() {
                this.isPremium = true;
                localStorage.setItem('funkenflug_premium', 'true');
                this.updatePremiumUI();
                this.closeSupportModal();
                this.showToast(this.t('toast').premium, 'premium');
            }

            showCryptoOptions() {
                alert('Crypto Spenden:\n\nBTC: bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh\n\nNach Zahlung: hans.swathi@example.com');
            }

            // ==================== LANGUAGE ====================
            generateLanguageGrid() {
                const grid = document.getElementById('languageGrid');
                grid.innerHTML = '';
                Object.keys(TRANSLATIONS).forEach(key => {
                    const lang = TRANSLATIONS[key];
                    const btn = document.createElement('button');
                    btn.className = 'lang-btn-large';
                    btn.innerHTML = `${lang.flag} ${lang.name}`;
                    btn.onclick = () => this.setLanguage(key);
                    if (key === this.lang) btn.classList.add('active');
                    grid.appendChild(btn);
                });
            }

            setLanguage(lang, save = true) {
                this.lang = lang;
                if (save) localStorage.setItem('funkenflug_lang', lang);
                
                const t = TRANSLATIONS[lang] || TRANSLATIONS.de;
                document.documentElement.lang = lang;
                document.documentElement.dir = t.dir || 'ltr';
                document.getElementById('currentLang').innerText = t.code;
                
                // Update texts
                const elements = ['subtitle', 'tagModes', 'tagVideo', 'btnNewGame', 'btnDemo', 
                    'btnDetailedRules', 'lobbyTitle', 'btnAddHuman', 'btnAddBot', 'btnStart', 
                    'btnBack', 'rulesMainTitle', 'btnBackToMenu', 'langTitle', 'btnBackLang',
                    'freeRoundsText', 'winnerTitle', 'btnNextRound', 'btnMainMenu'];
                
                elements.forEach(id => {
                    const el = document.getElementById(id);
                    if (el && t[id]) el.innerText = t[id];
                });

                // Update deck buttons if translated
                if (t.btnDeckClassic) document.getElementById('btnDeckClassic').innerText = t.btnDeckClassic;
                if (t.btnDeckNsfw) document.getElementById('btnDeckNsfw').innerText = t.btnDeckNsfw;
                if (t.btnDeckTech) document.getElementById('btnDeckTech').innerText = t.btnDeckTech;

                document.querySelectorAll('.lang-btn-large').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.innerHTML.includes(t.flag)) btn.classList.add('active');
                });

                this.renderRulesPage();
                this.updateLobby();
            }

            t(key) {
                return (TRANSLATIONS[this.lang] && TRANSLATIONS[this.lang].toast && TRANSLATIONS[this.lang].toast[key]) || 
                       (TRANSLATIONS.de.toast && TRANSLATIONS.de.toast[key]) || key;
            }

            // ==================== RULES ====================
            renderRulesPage() {
                const rules = RULES_DATABASE[this.lang] || RULES_DATABASE.de;
                const page = rules.pages[this.currentRulePage];
                
                document.getElementById('rulesContent').innerHTML = `
                    <div class="rules-title" style="font-size: 18px; margin-bottom: 20px; text-align: center;">
                        ${page.title}
                    </div>
                    ${page.content}
                `;
                
                document.querySelectorAll('.step-dot').forEach((dot, idx) => {
                    dot.classList.toggle('active', idx === this.currentRulePage);
                });
            }

            showRulePage(pageIndex) {
                this.currentRulePage = pageIndex;
                this.renderRulesPage();
            }

            // ==================== LOBBY ====================
            addPlayer(isBot = false) {
                const nameInput = document.getElementById('playerNameInput');
                const name = isBot 
                    ? `Bot ${this.players.filter(p => p.isBot).length + 1}`
                    : (nameInput.value.trim() || `Spieler ${this.players.filter(p => !p.isBot).length + 1}`);
                
                if (this.players.length >= 8) {
                    this.showToast('Maximum 8 Spieler!', 'error');
                    return;
                }
                
                const player = { 
                    id: Date.now(), 
                    name: name, 
                    items: 5, 
                    isBot: isBot, 
                    botType: isBot ? 'ruderalis' : null,
                    out: false, 
                    score: 0 
                };
                
                this.players.push(player);
                nameInput.value = '';
                this.updateLobby();
                
                if (isBot) {
                    this.showToast(`Bot ${name} hinzugef√ºgt`, 'success');
                }
            }

            updateLobby() {
                const list = document.getElementById('lobbyList');
                if (this.players.length === 0) {
                    list.innerHTML = '<p style="color: var(--text-muted); text-align: center; font-style: italic;">Noch keine Spieler...</p>';
                } else {
                    list.innerHTML = this.players.map((p, i) => `
                        <div class="player-item">
                            <div>
                                <span class="player-name">${p.isBot ? 'ü§ñ' : 'üë§'} ${p.name}</span>
                                <span class="player-type">${p.isBot ? 'KI' : 'Mensch'}</span>
                            </div>
                            <button class="btn-icon" onclick="game.removePlayer(${i})" style="width: 30px; height: 30px;">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    `).join('');
                }
                document.getElementById('btnStart').disabled = this.players.length < 2;
            }

            removePlayer(idx) {
                this.players.splice(idx, 1);
                this.updateLobby();
            }

            selectMode(mode) {
                if (mode === 'chaos' && !this.isPremium) {
                    this.openSupportModal();
                    return;
                }
                this.currentMode = mode;
                document.querySelectorAll('.mode-card').forEach(c => c.classList.remove('selected'));
                document.querySelector(`[data-mode="${mode}"]`).classList.add('selected');
                document.getElementById('modeNextBtn').disabled = false;
            }

            // ==================== GAME LOGIC ====================
            startGame() {
                if (this.players.length < 2) return;
                
                this.gameActive = true;
                this.currentPlayerIdx = 0;
                this.roundsInCurrentGame = 0;
                this.round = 1;
                this.players.forEach(p => { p.items = 5; p.out = false; p.score = 0; });
                
                this.updateQueue();
                this.updateRoundDisplay();
                
                // If only one mode selected, go to game, else show mode selection
                if (this.players.length > 0) {
                    this.showScreen('modeScreen');
                }
            }

            startGameLoop() {
                if (this.currentMode === 'wheel') {
                    document.getElementById('wheelView').style.display = 'block';
                    document.getElementById('cardView').style.display = 'none';
                    this.updateCurrentPlayer();
                } else {
                    document.getElementById('wheelView').style.display = 'none';
                    document.getElementById('cardView').style.display = 'block';
                    this.nextCard();
                }
            }

            updateCurrentPlayer() {
                const p = this.players[this.currentPlayerIdx];
                document.getElementById('currentPlayerName').innerText = `${p.name} ist dran!`;
                document.getElementById('spinBtn').disabled = p.isBot;
                document.getElementById('spinResult').innerHTML = '';
                
                if (p.isBot) {
                    setTimeout(() => this.spinWheel(), 1500);
                }
            }

            spinWheel() {
                const btn = document.getElementById('spinBtn');
                btn.disabled = true;
                
                const rings = ['ringOuter', 'ringMid', 'ringInner', 'ringCore'];
                const results = [];
                
                rings.forEach((ring, index) => {
                    const el = document.getElementById(ring);
                    const rotation = 1440 + Math.random() * 1440;
                    const direction = index % 2 === 0 ? 1 : -1;
                    el.style.transform = `rotate(${direction * rotation}deg)`;
                    
                    const degrees = rotation % 360;
                    let result;
                    if (ring === 'ringOuter') {
                        const segments = ['Wahrheit', 'Pflicht', 'Quiz', 'Risiko', 'Chaos', 'Joker'];
                        result = segments[Math.floor(degrees / 60)];
                    } else if (ring === 'ringMid') {
                        const segments = ['Leicht', 'Mittel', 'Schwer', 'Extrem'];
                        result = segments[Math.floor(degrees / 90)];
                    } else if (ring === 'ringInner') {
                        const segments = ['Normal', 'Doppelt', 'Umkehr'];
                        result = segments[Math.floor(degrees / 120)];
                    } else {
                        result = Math.random() > 0.5 ? 'Bonus' : 'Strafe';
                    }
                    results.push(result);
                });

                setTimeout(() => {
                    this.showWheelResult(results);
                }, 4000);
            }

            showWheelResult(results) {
                const [category, intensity, modifier, core] = results;
                const container = document.getElementById('spinResult');
                
                let type = 'action';
                if (category === 'Quiz') type = 'quiz';
                else if (category === 'Chaos') type = 'chaos';
                else if (intensity === 'Extrem' || intensity === 'Schwer') type = 'z';
                
                this.currentCard = this.generateCard(type);
                
                container.innerHTML = `
                    <div style="background: rgba(212,175,55,0.1); border: 1px solid var(--gold-primary); border-radius: 12px; padding: 20px; margin-top: 20px;">
                        <div style="color: var(--gold-primary); font-weight: bold; margin-bottom: 10px;">
                            ${category} | ${intensity} | ${modifier} | ${core}
                        </div>
                        <button class="btn btn-gold" onclick="game.showCardFromWheel()">Karte anzeigen</button>
                    </div>
                `;
                
                if (modifier === 'Doppelt') this.stripMultiplier = 2;
                if (modifier === 'Umkehr') this.reverseDirection = !this.reverseDirection;
            }

            showCardFromWheel() {
                document.getElementById('wheelView').style.display = 'none';
                document.getElementById('cardView').style.display = 'block';
                this.displayCard();
            }

            generateCard(type) {
                const deck = (DECKS[this.lang] || DECKS.de)[this.currentDeck] || DECKS.de.classic;
                
                switch(type) {
                    case 'quiz':
                        return { cat: 'quiz', ...deck.quiz[Math.floor(Math.random() * deck.quiz.length)] };
                    case 'tabu':
                        return { cat: 'tabu', ...deck.tabu[Math.floor(Math.random() * deck.tabu.length)] };
                    case 'z':
                        return { cat: 'z', text: deck.zundstoff[Math.floor(Math.random() * deck.zundstoff.length)] };
                    case 'chaos':
                        return { cat: 'chaos', ...deck.chaos[Math.floor(Math.random() * deck.chaos.length)] };
                    default:
                        return { cat: 'action', text: deck.actions[Math.floor(Math.random() * deck.actions.length)] };
                }
            }

            nextCard() {
                // Check round limit
                if (!this.isPremium && this.roundsInCurrentGame >= 5) {
                    this.showToast('5 Runden gespielt! Premium erforderlich.', 'error');
                    this.openSupportModal();
                    return;
                }

                if (this.potActive && this.currentPlayerIdx !== this.betPlayer && !this.players[this.currentPlayerIdx].out) {
                    this.showChallengeModal();
                    return;
                }

                // Mode specific card selection
                let type;
                switch(this.currentMode) {
                    case 'quiz': type = 'quiz'; break;
                    case 'chaos': type = 'chaos'; break;
                    case 'blackjack': 
                        this.showBjModal(); 
                        return;
                    default:
                        const rand = Math.random();
                        if (rand < 0.15) type = 'chaos';
                        else if (rand < 0.35) type = 'quiz';
                        else if (rand < 0.5) type = 'tabu';
                        else if (rand < 0.65) type = 'z';
                        else type = 'action';
                }
                
                this.currentCard = this.generateCard(type);
                this.displayCard();
            }

            displayCard() {
                // Hide all cards
                document.querySelectorAll('.game-card').forEach(c => c.classList.remove('active'));
                
                const p = this.players[this.currentPlayerIdx];
                
                // Show current card
                switch(this.currentCard.cat) {
                    case 'action':
                        document.getElementById('text-action').innerText = this.currentCard.text;
                        document.getElementById('card-action').classList.add('active');
                        break;
                    case 'quiz':
                        document.getElementById('text-quiz').innerText = this.currentCard.q;
                        document.getElementById('quiz-feedback').innerText = '';
                        const opts = document.getElementById('quiz-options');
                        opts.innerHTML = this.currentCard.a.map((a,i) => 
                            `<button class="btn" onclick="game.checkQuiz(${i})" style="margin-bottom:8px;">${a}</button>`
                        ).join('');
                        document.getElementById('card-quiz').classList.add('active');
                        
                        // Start timer
                        setTimeout(() => {
                            const timer = document.getElementById('quizTimer');
                            if (timer) {
                                timer.style.width = '100%';
                                timer.style.transition = 'width 10s linear';
                                setTimeout(() => timer.style.width = '0%', 100);
                            }
                        }, 100);
                        break;
                    case 'tabu':
                        document.getElementById('text-tabu').innerText = this.currentCard.w;
                        document.getElementById('list-tabu').innerHTML = this.currentCard.f.map(f => 
                            `<div class="tabu-word">${f}</div>`
                        ).join('');
                        document.getElementById('card-tabu').classList.add('active');
                        break;
                    case 'z':
                        document.getElementById('text-z').innerText = this.currentCard.text;
                        document.getElementById('card-z').classList.add('active');
                        break;
                    case 'chaos':
                        document.getElementById('text-chaos').innerText = this.currentCard.n;
                        document.getElementById('sub-chaos').innerText = this.currentCard.d;
                        document.getElementById('card-chaos').classList.add('active');
                        this.handleChaosEvent();
                        return;
                }

                // Update controls
                document.getElementById('gameControls').style.display = this.currentCard.cat === 'quiz' ? 'none' : 'flex';
                document.getElementById('btnNext').style.display = 'none';
                
                // Bot turn
                if (p.isBot && this.currentCard.cat !== 'chaos') {
                    document.getElementById('gameControls').style.opacity = '0.5';
                    setTimeout(() => this.autoBotTurn(), 2000);
                } else {
                    document.getElementById('gameControls').style.opacity = '1';
                }
                
                this.updateHighStakesButton();
            }

            handleChaosEvent() {
                const e = this.currentCard.e;
                if (e === "double") this.stripMultiplier = 2;
                if (e === "triple") this.stripMultiplier = 3;
                if (e === "reverse") this.reverseDirection = !this.reverseDirection;
                
                this.showBotBubble('‚ö†Ô∏è CHAOS!', this.currentCard.d);
                document.getElementById('gameControls').style.display = 'none';
                document.getElementById('btnNext').style.display = 'block';
            }

            checkQuiz(selected) {
                const buttons = document.querySelectorAll('#quiz-options button');
                const correctIndex = this.currentCard.c;
                
                buttons.forEach((btn, idx) => {
                    btn.disabled = true;
                    if (idx === correctIndex) btn.classList.add('correct');
                    else if (idx === selected) btn.classList.add('wrong');
                });
                
                const feedback = document.getElementById('quiz-feedback');
                if (selected === correctIndex) {
                    feedback.innerHTML = `<span style="color: var(--accent-green);">${this.t('correct')}</span>`;
                    this.showToast(this.t('correct'), 'success');
                    setTimeout(() => this.success(), 1500);
                } else {
                    feedback.innerHTML = `<span style="color: var(--accent-red);">${this.t('wrong')}</span>`;
                    this.showToast(this.t('wrong'), 'error');
                    setTimeout(() => this.fail(), 1500);
                }
            }

            success() {
                this.players[this.currentPlayerIdx].score++;
                this.showNextOrContinue();
            }

            fail() {
                const p = this.players[this.currentPlayerIdx];
                p.items = Math.max(0, p.items - this.stripMultiplier);
                
                if (p.items <= 1 && !p.out) {
                    setTimeout(() => {
                        this.potActive = true;
                        this.betPlayer = this.currentPlayerIdx;
                        if (p.isBot) {
                            this.autoBotBet();
                        } else {
                            this.showBetModal();
                        }
                    }, 1000);
                } else {
                    this.showNextOrContinue();
                }
            }

            showNextOrContinue() {
                document.getElementById('gameControls').style.display = 'none';
                document.getElementById('btnNext').style.display = 'block';
                
                const p = this.players[this.currentPlayerIdx];
                if (p.isBot) {
                    setTimeout(() => this.next(), 1500);
                }
            }

            next() {
                this.stripMultiplier = 1;
                this.roundsInCurrentGame++;
                this.updateRoundDisplay();
                
                // Find next player
                let attempts = 0;
                do {
                    if (this.reverseDirection) {
                        this.currentPlayerIdx = (this.currentPlayerIdx - 1 + this.players.length) % this.players.length;
                    } else {
                        this.currentPlayerIdx = (this.currentPlayerIdx + 1) % this.players.length;
                    }
                    attempts++;
                } while (attempts < this.players.length && this.players[this.currentPlayerIdx].out);
                
                if (attempts >= this.players.length || this.checkWinCondition()) {
                    this.endGame();
                    return;
                }
                
                this.updateQueue();
                
                if (this.currentMode === 'wheel') {
                    document.getElementById('cardView').style.display = 'none';
                    document.getElementById('wheelView').style.display = 'block';
                    this.updateCurrentPlayer();
                } else {
                    this.nextCard();
                }
            }

            checkWinCondition() {
                const active = this.players.filter(p => !p.out);
                return active.length === 1;
            }

            // ==================== HIGH STAKES / BLACKJACK ====================
            showBetModal() {
                const p = this.players[this.betPlayer];
                document.getElementById('remainingItems').innerText = p.items;
                document.getElementById('videoUrlInput').value = '';
                document.getElementById('videoPreview').classList.remove('active');
                document.getElementById('betSummary').innerText = 'W√§hle die Dauer';
                document.getElementById('modal-bet').classList.add('active');
            }

            setBetRounds(r) {
                this.bjRounds = r;
                document.getElementById('betSummary').innerText = `${r} Runde(n)`;
            }

            updateVideoPreview() {
                const input = document.getElementById('videoUrlInput');
                const preview = document.getElementById('videoPreview');
                const url = input.value.trim();
                
                if (url) {
                    preview.textContent = url;
                    preview.classList.add('active');
                } else {
                    preview.classList.remove('active');
                }
            }

            confirmBet() {
                if (!this.bjRounds) {
                    this.showToast('W√§hle Runden!', 'error');
                    return;
                }
                
                this.currentVideoUrl = document.getElementById('videoUrlInput').value.trim();
                document.getElementById('modal-bet').classList.remove('active');
                
                const indicator = document.getElementById('potIndicator');
                indicator.classList.add('active');
                if (this.currentVideoUrl) {
                    indicator.classList.add('video-active');
                    document.getElementById('potText').innerText = 'üé¨ VIDEO POT';
                    this.showToast(this.t('videoSet'), 'video');
                }
                
                this.next();
            }

            fold() {
                const p = this.players[this.betPlayer];
                p.out = true;
                p.items = 0;
                document.getElementById('modal-bet').classList.remove('active');
                document.getElementById('potIndicator').classList.remove('active');
                this.potActive = false;
                this.updateQueue();
                this.next();
            }

            showChallengeModal() {
                const better = this.players[this.betPlayer];
                document.getElementById('challengePlayerName').innerText = better.name;
                const box = document.getElementById('challengeVideoBox');
                if (this.currentVideoUrl) {
                    box.innerText = this.currentVideoUrl;
                    box.style.display = 'block';
                } else {
                    box.style.display = 'none';
                }
                document.getElementById('modal-challenge').classList.add('active');
            }

            acceptChallenge() {
                document.getElementById('modal-challenge').classList.remove('active');
                this.startBlackjack(true);
            }

            declineChallenge() {
                document.getElementById('modal-challenge').classList.remove('active');
                this.next();
            }

            startBlackjack(isChallenge = false) {
                this.isChallenge = isChallenge;
                document.getElementById('modal-bj').classList.add('active');
                
                this.bjGame = {
                    playerHand: [this.drawCard(), this.drawCard()],
                    dealerHand: [this.drawCard(), this.drawCard()],
                    playerScore: 0,
                    dealerScore: 0
                };
                
                this.updateBJDisplay();
            }

            drawCard() {
                const value = Math.floor(Math.random() * 10) + 2;
                return value > 11 ? 10 : value;
            }

            updateBJDisplay() {
                this.bjGame.playerScore = this.calculateScore(this.bjGame.playerHand);
                this.bjGame.dealerScore = this.calculateScore(this.bjGame.dealerHand);
                
                document.getElementById('bjPlayerScore').innerText = this.bjGame.playerScore;
                document.getElementById('bjPlayerHand').innerHTML = this.renderHand(this.bjGame.playerHand);
                
                const oppName = this.isChallenge ? this.players[this.betPlayer]?.name : 'Bank';
                document.getElementById('bjOppName').innerText = oppName;
                document.getElementById('bjOppScore').innerText = '?';
                document.getElementById('bjOppHand').innerHTML = 
                    this.renderCard(this.bjGame.dealerHand[0]) + 
                    '<div class="playing-card" style="background: linear-gradient(135deg, #b91c1c, #7f1d1d);"></div>';
            }

            renderHand(hand) {
                return hand.map(v => this.renderCard(v)).join('');
            }

            renderCard(value) {
                const isRed = Math.random() > 0.5;
                const display = value === 11 ? 'A' : value === 10 ? '10' : value;
                return `<div class="playing-card ${isRed ? 'red' : ''}">${display}</div>`;
            }

            calculateScore(hand) {
                let score = 0;
                let aces = 0;
                hand.forEach(card => {
                    if (card === 11) aces++;
                    score += card;
                });
                while (score > 21 && aces > 0) {
                    score -= 10;
                    aces--;
                }
                return score;
            }

            bjHit() {
                this.bjGame.playerHand.push(this.drawCard());
                this.updateBJDisplay();
                
                if (this.bjGame.playerScore > 21) {
                    setTimeout(() => this.bjLost(), 1000);
                }
            }

            bjStand() {
                document.getElementById('bjOppScore').innerText = this.bjGame.dealerScore;
                document.getElementById('bjOppHand').innerHTML = this.renderHand(this.bjGame.dealerHand);
                
                setTimeout(() => {
                    const player = this.bjGame.playerScore;
                    const dealer = this.bjGame.dealerScore;
                    
                    if (player > 21 || (dealer <= 21 && dealer > player)) {
                        this.bjLost();
                    } else {
                        this.bjWon();
                    }
                }, 1500);
            }

            bjWon() {
                document.getElementById('modal-bj').classList.remove('active');
                this.showToast(this.t('won'), 'success');
                
                if (this.isChallenge) {
                    const challenger = this.players[this.currentPlayerIdx];
                    challenger.items += 2;
                    this.players[this.betPlayer].out = true;
                } else {
                    this.players[this.betPlayer].items += this.bjRounds;
                }
                
                this.cleanupBet();
            }

            bjLost() {
                document.getElementById('modal-bj').classList.remove('active');
                this.showToast(this.t('lost'), 'error');
                
                if (this.isChallenge) {
                    this.players[this.currentPlayerIdx].out = true;
                } else {
                    this.players[this.betPlayer].out = true;
                }
                
                this.cleanupBet();
            }

            cleanupBet() {
                this.potActive = false;
                document.getElementById('potIndicator').classList.remove('active');
                this.bjRounds = 0;
                this.currentVideoUrl = '';
                this.isChallenge = false;
                this.updateQueue();
                setTimeout(() => this.next(), 2000);
            }

            autoBotBet() {
                this.bjRounds = Math.random() < 0.6 ? 1 : 3;
                if (Math.random() < 0.3) {
                    this.currentVideoUrl = 'https://tiktok.com/@bot/video/123';
                }
                setTimeout(() => {
                    document.getElementById('modal-bet').classList.remove('active');
                    document.getElementById('potIndicator').classList.add('active');
                    this.next();
                }, 1000);
            }

            showBj() {
                const p = this.players[this.currentPlayerIdx];
                if (p && p.items <= 1 && !p.out) {
                    this.betPlayer = this.currentPlayerIdx;
                    this.showBetModal();
                }
            }

            // ==================== UTILITIES ====================
            updateQueue() {
                const queue = document.getElementById('playerQueue');
                queue.innerHTML = this.players.map((p, i) => `
                    <div class="player-chip ${i === this.currentPlayerIdx ? 'active' : ''} ${p.isBot ? 'bot' : ''} ${p.out ? 'out' : ''}">
                        ${p.isBot ? 'ü§ñ' : 'üë§'} ${p.name} (${p.items})
                    </div>
                `).join('');
                this.updateHighStakesButton();
            }

            updateHighStakesButton() {
                const p = this.players[this.currentPlayerIdx];
                const btn = document.getElementById('btnHighStakes');
                if (p && p.items <= 1 && !p.out && !p.isBot) {
                    btn.style.display = 'block';
                } else {
                    btn.style.display = 'none';
                }
            }

            autoBotTurn() {
                const p = this.players[this.currentPlayerIdx];
                if (!p || !p.isBot) return;
                
                const botType = this.botTypes[p.botType] || this.botTypes.ruderalis;
                const riskThreshold = botType.risk;
                
                setTimeout(() => {
                    if (this.currentCard.cat === 'quiz') {
                        const correct = Math.random() < 0.6;
                        this.checkQuiz(correct ? this.currentCard.c : (this.currentCard.c + 1) % 3);
                    } else {
                        const success = Math.random() < riskThreshold;
                        success ? this.success() : this.fail();
                    }
                }, 1500);
            }

            endGame() {
                this.showScreen('resultScreen');
                const active = this.players.filter(p => !p.out);
                let winner = active[0] || this.players[0];
                
                if (active.length > 1) {
                    winner = active.reduce((a,b) => a.items > b.items ? a : b);
                }
                
                document.getElementById('winnerName').innerText = winner.name;
                
                // Show scores
                const sorted = [...this.players].sort((a,b) => b.items - a.items);
                document.getElementById('finalScores').innerHTML = sorted.map((p,i) => `
                    <div style="display: flex; justify-content: space-between; padding: 10px; background: ${i===0?'rgba(212,175,55,0.2)':'rgba(255,255,255,0.05)'}; border-radius: 8px; margin-bottom: 5px;">
                        <span>${i+1}. ${p.name} ${p.isBot?'ü§ñ':''}</span>
                        <span style="color: var(--gold-primary);">${p.items} Items</span>
                    </div>
                `).join('');
            }

            nextRound() {
                this.players.forEach(p => { p.items = 5; p.out = false; p.score = 0; });
                this.roundsInCurrentGame = 0;
                this.startGame();
            }

            demoMode() {
                this.players = [
                    { id: 1, name: 'Indica', items: 5, isBot: true, botType: 'indica', out: false, score: 0 },
                    { id: 2, name: 'Sativa', items: 5, isBot: true, botType: 'sativa', out: false, score: 0 },
                    { id: 3, name: 'Spieler', items: 5, isBot: false, out: false, score: 0 }
                ];
                this.currentMode = 'classic';
                this.showGame();
            }

            showToast(msg, type = 'default') {
                const toast = document.getElementById('toast');
                toast.textContent = msg;
                toast.className = `toast show ${type}`;
                setTimeout(() => toast.classList.remove('show'), 3000);
            }

            updateTimestamp() {
                const now = new Date();
                document.getElementById('timestamp').innerText = now.toLocaleDateString() + ' ' + 
                    now.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
            }

            showBotBubble(name, text) {
                document.getElementById('botSpeakerName').innerText = name;
                document.getElementById('botSpeech').innerText = text;
                const bubble = document.getElementById('botBubble');
                bubble.classList.add('active');
                setTimeout(() => bubble.classList.remove('active'), 4000);
            }

            showPotDetails() {
                if (this.currentVideoUrl) {
                    alert(`üé¨ Aktiver Video Einsatz:\n${this.currentVideoUrl}`);
                }
            }
        }

        // Initialize
        const game = new GameController();
        game.init();

        // Close modals on outside click
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal && !['modal-bet','modal-challenge','modal-bj'].includes(modal.id)) {
                    modal.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>
